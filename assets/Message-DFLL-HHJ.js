import{a as fe,r as w,j as N}from"./iframe-Cc9wzQT7.js";import{u as oe,p as me,a as ie,b as ye,i as ve,c as pe}from"./index-B9TlbZJD.js";import{a as ce}from"./animate.module-CI42XwLX.js";var b={},ue;function he(){if(ue)return b;ue=1,Object.defineProperty(b,"__esModule",{value:!0});var h=fe();function K(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var r=K(h);const A=.3,$="linear",O="normal",M="none",k="running",q="paused",z="all";var B=({duration:e=A,delay:t=0,overlay:n=0})=>e+t-n||0,L=e=>e===void 0;function P(e,t,n){return L(t)&&L(e)?n||0:e&&e>=0?e:t||0}const U=r.createContext({animationStates:{},register:()=>{}});function X({play:e,sequences:t=[],children:n}){const[i,l]=r.useState({}),d=r.useRef({}),o=r.useCallback(s=>{const{sequenceIndex:a,sequenceId:f}=s;(!L(f)||!L(a))&&(d.current[P(a,f)]=s)},[]);return r.useEffect(()=>{const s=Array.isArray(t)&&t.length?t:Object.values(d.current),a={};(e?s:[...s].reverse()).reduce((f,{sequenceId:y,sequenceIndex:v,duration:p=A,delay:c,overlay:u},m)=>{const _=P(v,y,m),T=B({duration:p,delay:c,overlay:u})+f;return a[_]={play:e,pause:!e,delay:(c||0)+f,controlled:!0},T},0),l(a)},[e]),r.createElement(U.Provider,{value:{animationStates:i,register:o}},n)}var ee=e=>(e||0)*1e3;function te(e){const{play:t,children:n,render:i,start:l,end:d,complete:o="",onComplete:s,delay:a=0,duration:f=A,easeType:y=$,sequenceId:v,sequenceIndex:p}=e,c=r.useRef(),[u,m]=r.useState(l||{}),{register:_,animationStates:g={}}=r.useContext(U),T=P(p,v);return r.useEffect(()=>{(!L(p)&&p>=0||v)&&_(e)},[]),r.useEffect(()=>{const R=g[T]||{};return m({...t||R.play?d:l,transition:`${z} ${f}s ${y} ${R.delay||a}s`}),t&&(o||s)&&(c.current=setTimeout(()=>{o&&m(o),s&&s()},ee((R.delay||a)+f))),()=>c.current&&clearTimeout(c.current)},[T,g,t,f,y,a,s,l,d,o]),i?i({style:u}):r.createElement("div",{style:u},n)}var ae=e=>e?e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`):"";const F=e=>{const t=e.length;return e.reduce((n,i,l)=>{const d=parseFloat((100/(t-1)).toFixed(2))*l;if(typeof i=="string")return`${n} ${d}% {${i}}`;const o=Object.keys(i);if(o.length&&isNaN(+o[0])){const s=o.reduce((a,f)=>`${a} ${ae(f)}: ${i[f]};`,"");return`${n} ${d}% {${s}}`}return`${n} ${o[0]}% {${i[o[0]]}}`},"")};function V({keyframes:e,animationName:t}){return`@keyframes ${t} {${F(e)}}`}function x({keyframes:e,animationName:t}){var n,i,l,d;let o=document.querySelector("style[data-id=rsi]");o||(o=document.createElement("style"),o.setAttribute("data-id","rsi"),document.head.appendChild(o));const s=(l=(i=(n=o.sheet)===null||n===void 0?void 0:n.cssRules)===null||i===void 0?void 0:i.length)!==null&&l!==void 0?l:0;try{(d=o.sheet)===null||d===void 0||d.insertRule(V({keyframes:e,animationName:t}),s)}catch(a){console.error("react simple animate, error found during insert style ",a)}return{styleTag:o,index:s}}var C=(e,t)=>{if(!e)return;const n=Object.values(e.cssRules).findIndex(({name:i})=>i===t);n>=0&&e.deleteRule(n)},j=()=>`RSI-${Math.random().toString(36).substr(2,9)}`,H=e=>e?q:k;function Y(e){const{children:t,play:n=!1,pause:i=!1,render:l,duration:d=A,delay:o=0,easeType:s=$,direction:a=O,fillMode:f=M,iterationCount:y=1,sequenceIndex:v,keyframes:p,sequenceId:c}=e;let u;const m=r.useRef({forward:"",reverse:""}),_=r.useRef(!1),g=r.useRef({forward:null,reverse:null}),T=P(v,c),{register:R,animationStates:D={}}=r.useContext(U),E=D[T]||{},[,ne]=r.useState(!1);r.useEffect(()=>{const J=g.current,Q=m.current;m.current.forward=j();let I=x({animationName:m.current.forward,keyframes:p});return g.current.forward=I.styleTag,m.current.reverse=j(),I=x({animationName:m.current.reverse,keyframes:p.reverse()}),g.current.reverse=I.styleTag,R(e),n&&ne(!0),()=>{var G,se;C((G=J.forward)===null||G===void 0?void 0:G.sheet,Q.forward),C((se=J.reverse)===null||se===void 0?void 0:se.sheet,Q.reverse)}},[]),E.controlled&&!_.current?(u=E.pause,E.pause||(_.current=!0)):u=i;const Z={animation:`${d}s ${s} ${E.delay||o}s ${y} ${a} ${f} ${H(u)} ${((E.controlled?E.play:n)?m.current.forward:m.current.reverse)||""}`};return l?l({style:Z}):r.createElement("div",{style:Z||{}},t)}function S(e){const{start:t,end:n,complete:i,onComplete:l,delay:d=0,duration:o=A,easeType:s=$}=e,a=r.useMemo(()=>`${z} ${o}s ${s} ${d}s`,[o,s,d]),[f,y]=r.useState({isPlaying:!1,style:{...t,transition:a}}),{isPlaying:v,style:p}=f,c=r.useRef();return r.useEffect(()=>((l||i)&&v&&(c.current=setTimeout(()=>{l&&l(),i&&y(u=>({...u,style:i}))},ee(d+o))),()=>c.current&&clearTimeout(c.current)),[f,i,d,o,v,l]),{isPlaying:v,style:p,play:r.useCallback(u=>{y(m=>({...m,style:{...u?n:t,transition:a},isPlaying:u}))},[n,t,a])}}function re(e){const{duration:t=A,delay:n=0,easeType:i=$,direction:l=O,fillMode:d=M,iterationCount:o=1,keyframes:s}=e,a=r.useRef({forward:"",reverse:""}),f=r.useRef({forward:null,reverse:null}),{register:y}=r.useContext(U),[v,p]=r.useState(null),[c,u]=r.useState(!1);return r.useEffect(()=>{const _=f.current,g=a.current;a.current.forward=j();let T=x({animationName:a.current.forward,keyframes:s});return f.current.forward=T.styleTag,a.current.reverse=j(),T=x({animationName:a.current.reverse,keyframes:s.reverse()}),f.current.reverse=T.styleTag,y(e),()=>{var R,D;C((R=_.forward)===null||R===void 0?void 0:R.sheet,g.forward),C((D=_.reverse)===null||D===void 0?void 0:D.sheet,g.reverse)}},[]),{style:{animation:`${t}s ${i} ${n}s ${o} ${l} ${d} ${H(c)} ${v===null?"":v?a.current.forward:a.current.reverse}`},play:p,pause:u,isPlaying:!!v}}function le(e){return Array.from({length:e},()=>null)}function de(e){const{sequences:t=[]}=e,n=le(t.length).map((y,v)=>e.sequences[v].start),[i,l]=r.useState(n),[d,o]=r.useState(!1),s=r.useRef([]),a=r.useRef([]);r.useEffect(()=>{t.forEach(({keyframes:p},c)=>{if(!Array.isArray(p))return;s.current[c]||(s.current[c]={},a.current[c]={}),s.current[c].forward=j();let u=x({animationName:s.current[c].forward,keyframes:p});a.current[c].forward=u.styleTag,s.current[c].reverse=j(),u=x({animationName:s.current[c].reverse,keyframes:p.reverse()}),a.current[c].reverse=u.styleTag});const y=a.current,v=s.current;return()=>Object.values(v).forEach(({forward:p,reverse:c},u)=>{var m,_;C((m=y[u].forward)===null||m===void 0?void 0:m.sheet,p),C((_=y[u].reverse)===null||_===void 0?void 0:_.sheet,c)})},[]);const f=r.useCallback(y=>{let v=0;const p=y?s.current:[...s.current].reverse(),c=(y?t:[...t].reverse()).map((u,m)=>{const{duration:_=A,delay:g=0,overlay:T,keyframes:R,iterationCount:D=1,easeType:E=$,direction:ne=O,fillMode:Z=M,end:J={},start:Q={}}=u,I=m===0?g:v,G=`${z} ${_}s ${E} ${I}s`;return v=B({duration:_,delay:g,overlay:T})+v,R?{animation:`${_}s ${E} ${I}s ${D} ${ne} ${Z} ${k} ${y?p[m].forward:p[m].reverse}`}:{...y?J:Q,transition:G}});l(y?c:[...c].reverse()),o(y)},[]);return{styles:i,play:f,isPlaying:d}}return b.Animate=te,b.AnimateGroup=X,b.AnimateKeyframes=Y,b.useAnimate=S,b.useAnimateGroup=de,b.useAnimateKeyframes=re,b}var _e=he();const $e="_message_wnudf_1",ge="_nickname_wnudf_22",Te="_text_wnudf_1",W={message:$e,nickname:ge,text:Te},we=({message:h,callback:K})=>{var Y;const[r,A]=w.useState(!0),$=w.useRef(null),O=oe(S=>S.parser),M=oe(S=>S.parseToLink),[k]=w.useState(me(h.message)),[q,z]=w.useState(ie(10,40)),[B,L]=w.useState(q*.7),[P,U]=w.useState(ie(.4,.6)),[X,ee]=w.useState(ve(h.colorHex??"white")?ye(P):h.colorHex??"white"),[te,ae]=w.useState(`linear-gradient(125deg, ${X} , transparent 75%) border-box`),[F,V]=w.useState({visibility:"hidden",fontSize:q+"px",position:"absolute",background:h.isVip||h.isModerator||h.isBroadcaster?te:void 0,margin:q/10+"px"}),[x,C]=w.useState(0),{play:j,style:H}=_e.useAnimate({duration:B,start:{...F,left:window.outerWidth+x+"px"},end:{...F,left:x*-1-100+"px"},onComplete:()=>{A(!1)}});return w.useEffect(()=>{const S=$.current,re=Math.floor(Math.random()*(window.innerHeight-S.offsetHeight));V({...F,top:re+"px",visibility:"visible",left:window.outerWidth+"px"})},[h.id]),w.useEffect(()=>{$.current&&$.current.offsetWidth&&(C($.current.offsetWidth),V(S=>({...S,left:window.outerWidth+x+"px"}))),x!==0&&j(!0)},[(Y=$.current)==null?void 0:Y.offsetWidth]),!O||!M?r&&N.jsxs("div",{ref:$,style:H,className:W.message+" "+ce.animated,onAnimationEnd:K,children:[N.jsxs("div",{id:`${h.id}_nickname`,className:W.nickname,style:{color:h.colorHex},children:[h.displayName,":"]}),N.jsx("div",{className:W.text,style:{color:"white",marginLeft:"10px"},children:h.message})]},h.id):r&&N.jsxs("div",{ref:$,style:H,className:W.message+" "+ce.animated,onAnimationEnd:K,children:[N.jsxs("div",{id:`${h.id}_nickname`,className:W.nickname,style:{color:h.colorHex},children:[h.displayName,":"]}),N.jsx("div",{className:W.text,style:{color:"white",marginLeft:"10px"},children:k==null?void 0:k.map(S=>{switch(S.type){case"text":return pe({text:h,parser:O,newParser:M});case"image":return N.jsx("span",{children:"Ссылка"});case"link":return N.jsx("span",{children:"Ссылка"});case"video":return N.jsx("span",{children:"Ссылка"})}})})]},h.id)};we.__docgenInfo={description:"",methods:[],displayName:"Message",props:{message:{required:!0,tsType:{name:"ChatMessage"},description:""},callback:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{we as M};
