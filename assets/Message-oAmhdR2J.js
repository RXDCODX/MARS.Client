import{a as fe,r as S,j as b}from"./iframe-Bw5_no3n.js";import{a as ne}from"./animate.module-CI42XwLX.js";import{u as se,p as me,b as ae,c as ye,i as ve,r as pe}from"./index-CD2mETMy.js";import{G as he}from"./GradientText-BaZSLpA_.js";var N={},oe;function $e(){if(oe)return N;oe=1,Object.defineProperty(N,"__esModule",{value:!0});var l=fe();function K(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),r.default=e,Object.freeze(r)}var t=K(l);const _=.3,C="linear",R="normal",k="none",F="running",Q="paused",j="all";var z=({duration:e=_,delay:r=0,overlay:n=0})=>e+r-n||0,D=e=>e===void 0;function L(e,r,n){return D(r)&&D(e)?n||0:e&&e>=0?e:r||0}const P=t.createContext({animationStates:{},register:()=>{}});function I({play:e,sequences:r=[],children:n}){const[i,d]=t.useState({}),f=t.useRef({}),o=t.useCallback(s=>{const{sequenceIndex:a,sequenceId:m}=s;(!D(m)||!D(a))&&(f.current[L(a,m)]=s)},[]);return t.useEffect(()=>{const s=Array.isArray(r)&&r.length?r:Object.values(f.current),a={};(e?s:[...s].reverse()).reduce((m,{sequenceId:v,sequenceIndex:p,duration:h=_,delay:c,overlay:u},y)=>{const g=L(p,v,y),T=z({duration:h,delay:c,overlay:u})+m;return a[g]={play:e,pause:!e,delay:(c||0)+m,controlled:!0},T},0),d(a)},[e]),t.createElement(P.Provider,{value:{animationStates:i,register:o}},n)}var G=e=>(e||0)*1e3;function M(e){const{play:r,children:n,render:i,start:d,end:f,complete:o="",onComplete:s,delay:a=0,duration:m=_,easeType:v=C,sequenceId:p,sequenceIndex:h}=e,c=t.useRef(),[u,y]=t.useState(d||{}),{register:g,animationStates:w={}}=t.useContext(P),T=L(h,p);return t.useEffect(()=>{(!D(h)&&h>=0||p)&&g(e)},[]),t.useEffect(()=>{const A=w[T]||{};return y({...r||A.play?f:d,transition:`${j} ${m}s ${v} ${A.delay||a}s`}),r&&(o||s)&&(c.current=setTimeout(()=>{o&&y(o),s&&s()},G((A.delay||a)+m))),()=>c.current&&clearTimeout(c.current)},[T,w,r,m,v,a,s,d,f,o]),i?i({style:u}):t.createElement("div",{style:u},n)}var X=e=>e?e.replace(/[A-Z]/g,r=>`-${r.toLowerCase()}`):"";const B=e=>{const r=e.length;return e.reduce((n,i,d)=>{const f=parseFloat((100/(r-1)).toFixed(2))*d;if(typeof i=="string")return`${n} ${f}% {${i}}`;const o=Object.keys(i);if(o.length&&isNaN(+o[0])){const s=o.reduce((a,m)=>`${a} ${X(m)}: ${i[m]};`,"");return`${n} ${f}% {${s}}`}return`${n} ${o[0]}% {${i[o[0]]}}`},"")};function V({keyframes:e,animationName:r}){return`@keyframes ${r} {${B(e)}}`}function $({keyframes:e,animationName:r}){var n,i,d,f;let o=document.querySelector("style[data-id=rsi]");o||(o=document.createElement("style"),o.setAttribute("data-id","rsi"),document.head.appendChild(o));const s=(d=(i=(n=o.sheet)===null||n===void 0?void 0:n.cssRules)===null||i===void 0?void 0:i.length)!==null&&d!==void 0?d:0;try{(f=o.sheet)===null||f===void 0||f.insertRule(V({keyframes:e,animationName:r}),s)}catch(a){console.error("react simple animate, error found during insert style ",a)}return{styleTag:o,index:s}}var x=(e,r)=>{if(!e)return;const n=Object.values(e.cssRules).findIndex(({name:i})=>i===r);n>=0&&e.deleteRule(n)},W=()=>`RSI-${Math.random().toString(36).substr(2,9)}`,re=e=>e?Q:F;function ie(e){const{children:r,play:n=!1,pause:i=!1,render:d,duration:f=_,delay:o=0,easeType:s=C,direction:a=R,fillMode:m=k,iterationCount:v=1,sequenceIndex:p,keyframes:h,sequenceId:c}=e;let u;const y=t.useRef({forward:"",reverse:""}),g=t.useRef(!1),w=t.useRef({forward:null,reverse:null}),T=L(p,c),{register:A,animationStates:O={}}=t.useContext(P),E=O[T]||{},[,ee]=t.useState(!1);t.useEffect(()=>{const Z=w.current,J=y.current;y.current.forward=W();let q=$({animationName:y.current.forward,keyframes:h});return w.current.forward=q.styleTag,y.current.reverse=W(),q=$({animationName:y.current.reverse,keyframes:h.reverse()}),w.current.reverse=q.styleTag,A(e),n&&ee(!0),()=>{var H,te;x((H=Z.forward)===null||H===void 0?void 0:H.sheet,J.forward),x((te=Z.reverse)===null||te===void 0?void 0:te.sheet,J.reverse)}},[]),E.controlled&&!g.current?(u=E.pause,E.pause||(g.current=!0)):u=i;const Y={animation:`${f}s ${s} ${E.delay||o}s ${v} ${a} ${m} ${re(u)} ${((E.controlled?E.play:n)?y.current.forward:y.current.reverse)||""}`};return d?d({style:Y}):t.createElement("div",{style:Y||{}},r)}function ce(e){const{start:r,end:n,complete:i,onComplete:d,delay:f=0,duration:o=_,easeType:s=C}=e,a=t.useMemo(()=>`${j} ${o}s ${s} ${f}s`,[o,s,f]),[m,v]=t.useState({isPlaying:!1,style:{...r,transition:a}}),{isPlaying:p,style:h}=m,c=t.useRef();return t.useEffect(()=>((d||i)&&p&&(c.current=setTimeout(()=>{d&&d(),i&&v(u=>({...u,style:i}))},G(f+o))),()=>c.current&&clearTimeout(c.current)),[m,i,f,o,p,d]),{isPlaying:p,style:h,play:t.useCallback(u=>{v(y=>({...y,style:{...u?n:r,transition:a},isPlaying:u}))},[n,r,a])}}function ue(e){const{duration:r=_,delay:n=0,easeType:i=C,direction:d=R,fillMode:f=k,iterationCount:o=1,keyframes:s}=e,a=t.useRef({forward:"",reverse:""}),m=t.useRef({forward:null,reverse:null}),{register:v}=t.useContext(P),[p,h]=t.useState(null),[c,u]=t.useState(!1);return t.useEffect(()=>{const g=m.current,w=a.current;a.current.forward=W();let T=$({animationName:a.current.forward,keyframes:s});return m.current.forward=T.styleTag,a.current.reverse=W(),T=$({animationName:a.current.reverse,keyframes:s.reverse()}),m.current.reverse=T.styleTag,v(e),()=>{var A,O;x((A=g.forward)===null||A===void 0?void 0:A.sheet,w.forward),x((O=g.reverse)===null||O===void 0?void 0:O.sheet,w.reverse)}},[]),{style:{animation:`${r}s ${i} ${n}s ${o} ${d} ${f} ${re(c)} ${p===null?"":p?a.current.forward:a.current.reverse}`},play:h,pause:u,isPlaying:!!p}}function le(e){return Array.from({length:e},()=>null)}function de(e){const{sequences:r=[]}=e,n=le(r.length).map((v,p)=>e.sequences[p].start),[i,d]=t.useState(n),[f,o]=t.useState(!1),s=t.useRef([]),a=t.useRef([]);t.useEffect(()=>{r.forEach(({keyframes:h},c)=>{if(!Array.isArray(h))return;s.current[c]||(s.current[c]={},a.current[c]={}),s.current[c].forward=W();let u=$({animationName:s.current[c].forward,keyframes:h});a.current[c].forward=u.styleTag,s.current[c].reverse=W(),u=$({animationName:s.current[c].reverse,keyframes:h.reverse()}),a.current[c].reverse=u.styleTag});const v=a.current,p=s.current;return()=>Object.values(p).forEach(({forward:h,reverse:c},u)=>{var y,g;x((y=v[u].forward)===null||y===void 0?void 0:y.sheet,h),x((g=v[u].reverse)===null||g===void 0?void 0:g.sheet,c)})},[]);const m=t.useCallback(v=>{let p=0;const h=v?s.current:[...s.current].reverse(),c=(v?r:[...r].reverse()).map((u,y)=>{const{duration:g=_,delay:w=0,overlay:T,keyframes:A,iterationCount:O=1,easeType:E=C,direction:ee=R,fillMode:Y=k,end:Z={},start:J={}}=u,q=y===0?w:p,H=`${j} ${g}s ${E} ${q}s`;return p=z({duration:g,delay:w,overlay:T})+p,A?{animation:`${g}s ${E} ${q}s ${O} ${ee} ${Y} ${F} ${v?h[y].forward:h[y].reverse}`}:{...v?Z:J,transition:H}});d(v?c:[...c].reverse()),o(v)},[]);return{styles:i,play:m,isPlaying:f}}return N.Animate=M,N.AnimateGroup=I,N.AnimateKeyframes=ie,N.useAnimate=ce,N.useAnimateGroup=de,N.useAnimateKeyframes=ue,N}var ge=$e();const xe="_message_wnudf_1",we="_nickname_wnudf_22",Te="_text_wnudf_1",U={message:xe,nickname:we,text:Te},Se=({message:l,callback:K,slotTop:t})=>{const[_,C]=S.useState(!0),R=S.useRef(null),k=se($=>$.parser),F=se($=>$.parseToLink),[Q]=S.useState(me(l.message)),[j]=S.useState(ae(10,40)),[z]=S.useState(j*.7),[D]=S.useState(ae(.4,.6)),[L]=S.useState(ve(l.colorHex??"white")?ye(D):l.colorHex??"white"),[P]=S.useState(`linear-gradient(125deg, ${L} , transparent 75%) border-box`),[I,G]=S.useState({visibility:"hidden",fontSize:j+"px",position:"absolute",background:l.isVip||l.isModerator||l.isBroadcaster?P:void 0,margin:j/10+"px",top:t!==void 0?t+"px":void 0}),[M,X]=S.useState(0),{play:B,style:V}=ge.useAnimate({duration:z,start:{...I,left:window.outerWidth+M+"px"},end:{...I,left:M*-1-100+"px"},onComplete:()=>{C(!1)}});return S.useEffect(()=>{const $=R.current,x=Math.floor(Math.random()*(window.innerHeight-$.offsetHeight));G({...I,top:t!==void 0?t+"px":x+"px",visibility:"visible",left:window.outerWidth+"px"})},[l.id,I,t]),S.useEffect(()=>{R.current&&R.current.offsetWidth&&(X(R.current.offsetWidth),G($=>({...$,left:window.outerWidth+M+"px"}))),M!==0&&B(!0)},[R.current?.offsetWidth,M,B]),!k||!F?_&&b.jsxs("div",{ref:R,style:V,className:U.message+" "+ne.animated,onAnimationEnd:K,children:[b.jsxs("div",{id:`${l.id}_nickname`,className:U.nickname,style:{color:l.colorHex},children:[l.displayName,":"]}),b.jsx("div",{className:U.text,style:{color:"white",marginLeft:"10px"},children:l.message})]},l.id):_&&b.jsxs("div",{ref:R,style:V,className:U.message+" "+ne.animated,onAnimationEnd:K,children:[b.jsxs("div",{id:`${l.id}_nickname`,className:U.nickname,style:{color:l.colorHex},children:[l.displayName,":"]}),b.jsx("div",{className:U.text,style:{color:"white",marginLeft:"10px"},children:Q?.map(($,x)=>{if(l.isBroadcaster||l.isVip||l.isModerator)return b.jsx(he,{text:typeof $.content=="string"?$.content:l.message??"",fontWeight:600,speed:"very-fast"},x);switch($.type){case"text":return pe({text:l,parser:k,newParser:F});case"image":return b.jsx("span",{children:"Ссылка"},x);case"link":return b.jsx("span",{children:"Ссылка"},x);case"video":return b.jsx("span",{children:"Ссылка"},x)}})})]},l.id)};Se.__docgenInfo={description:"",methods:[],displayName:"Message",props:{message:{required:!0,tsType:{name:"ChatMessage"},description:""},callback:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},slotTop:{required:!1,tsType:{name:"number"},description:""}}};export{Se as M};
