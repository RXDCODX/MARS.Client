import{a as ie,b as cn}from"./iframe-zpiOQtGo.js";const U=[];for(let r=0;r<256;++r)U.push((r+256).toString(16).slice(1));function co(r,e=0){return(U[r[e+0]]+U[r[e+1]]+U[r[e+2]]+U[r[e+3]]+"-"+U[r[e+4]]+U[r[e+5]]+"-"+U[r[e+6]]+U[r[e+7]]+"-"+U[r[e+8]]+U[r[e+9]]+"-"+U[r[e+10]]+U[r[e+11]]+U[r[e+12]]+U[r[e+13]]+U[r[e+14]]+U[r[e+15]]).toLowerCase()}let Bt;const ao=new Uint8Array(16);function uo(){if(!Bt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Bt=crypto.getRandomValues.bind(crypto)}return Bt(ao)}const lo=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),vn={randomUUID:lo};function rs(r,e,n){var i;if(vn.randomUUID&&!r)return vn.randomUUID();r=r||{};const t=r.random??((i=r.rng)==null?void 0:i.call(r))??uo();if(t.length<16)throw new Error("Random bytes length must be >= 16");return t[6]=t[6]&15|64,t[8]=t[8]&63|128,co(t)}var $t={exports:{}},Lt,mn;function fo(){if(mn)return Lt;mn=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Lt=r,Lt}var Ut,yn;function ho(){if(yn)return Ut;yn=1;var r=fo();function e(){}function n(){}return n.resetWarningCache=e,Ut=function(){function t(c,l,h,s,a,u){if(u!==r){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}t.isRequired=t;function i(){return t}var o={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:i,element:t,elementType:t,instanceOf:i,node:t,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return o.PropTypes=o,o},Ut}var bn;function po(){return bn||(bn=1,$t.exports=ho()()),$t.exports}var Ke={},_t={},vt={},wn;function go(){if(wn)return vt;wn=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.default=r;function r(e,n){if(e===n)return!0;var t=Object.keys(e),i=Object.keys(n);if(t.length!==i.length)return!1;for(var o=Object.prototype.hasOwnProperty,c=0;c<t.length;c++)if(!o.call(n,t[c])||e[t[c]]!==n[t[c]])return!1;return!0}return vt}var mt={},Wt={exports:{}},Cn;function _o(){if(Cn)return Wt.exports;Cn=1;var r=Wt.exports={},e,n;function t(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?e=setTimeout:e=t}catch{e=t}try{typeof clearTimeout=="function"?n=clearTimeout:n=i}catch{n=i}})();function o(_){if(e===setTimeout)return setTimeout(_,0);if((e===t||!e)&&setTimeout)return e=setTimeout,setTimeout(_,0);try{return e(_,0)}catch{try{return e.call(null,_,0)}catch{return e.call(this,_,0)}}}function c(_){if(n===clearTimeout)return clearTimeout(_);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(_);try{return n(_)}catch{try{return n.call(null,_)}catch{return n.call(this,_)}}}var l=[],h=!1,s,a=-1;function u(){!h||!s||(h=!1,s.length?l=s.concat(l):a=-1,l.length&&f())}function f(){if(!h){var _=o(u);h=!0;for(var g=l.length;g;){for(s=l,l=[];++a<g;)s&&s[a].run();a=-1,g=l.length}s=null,h=!1,c(_)}}r.nextTick=function(_){var g=new Array(arguments.length-1);if(arguments.length>1)for(var v=1;v<arguments.length;v++)g[v-1]=arguments[v];l.push(new d(_,g)),l.length===1&&!h&&o(f)};function d(_,g){this.fun=_,this.array=g}d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function p(){}return r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(_){return[]},r.binding=function(_){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(_){throw new Error("process.chdir is not supported")},r.umask=function(){return 0},Wt.exports}var Sn;function vo(){if(Sn)return mt;Sn=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.default=t;var r=_o(),e=n(r);function n(i){return i&&i.__esModule?i:{default:i}}function t(i,o){var c=[],l=0,h=!0;function s(u){function f(){o&&o(u,c)}h?e.default.nextTick(f):f()}function a(u,f){c.push(f),++l>=i.length||u?s(u):i[l](a)}i.length>0?i[0](a):s(null),h=!1}return mt}var yt={},kn;function mo(){if(kn)return yt;kn=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.default=e;var r=function(){};function e(n,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;n()?t(function o(c){for(var l=arguments.length,h=Array(l>1?l-1:0),s=1;s<l;s++)h[s-1]=arguments[s];c?i(c):n.apply(this,h)?t(o):i(null)}):i(null)}return yt}var bt={},En;function yo(){if(En)return bt;En=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.default=r;function r(e,n){var t=void 0,i=void 0,o=void 0,c=void 0,l=0;function h(){c=0,l=+new Date,o=e.apply(t,i),t=null,i=null}return function(){t=this,i=arguments;var a=new Date-l;return c||(a>=n?h():c=setTimeout(h,n-a)),o}}return bt}var wt={},Tn;function bo(){if(Tn)return wt;Tn=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=e;var r=0;function e(){return r++}return wt}var rt={},Rn;function wo(){if(Rn)return rt;Rn=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.innerHeight=r,rt.innerWidth=e;function r(n){var t=window.getComputedStyle(n,null);return t?n.clientHeight-parseInt(t.getPropertyValue("padding-top"),10)-parseInt(t.getPropertyValue("padding-bottom"),10):n.clientHeight}function e(n){var t=window.getComputedStyle(n,null);return t?n.clientWidth-parseInt(t.getPropertyValue("padding-left"),10)-parseInt(t.getPropertyValue("padding-right"),10):n.clientWidth}return rt}var Pn;function Co(){if(Pn)return _t;Pn=1,Object.defineProperty(_t,"__esModule",{value:!0});var r=Object.assign||function(w){for(var S=1;S<arguments.length;S++){var F=arguments[S];for(var E in F)Object.prototype.hasOwnProperty.call(F,E)&&(w[E]=F[E])}return w},e=function(){function w(S,F){for(var E=0;E<F.length;E++){var P=F[E];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(S,P.key,P)}}return function(S,F,E){return F&&w(S.prototype,F),E&&w(S,E),S}}(),n=ie(),t=v(n),i=po(),o=v(i),c=go(),l=v(c),h=vo(),s=v(h),a=mo(),u=v(a),f=yo(),d=v(f),p=bo(),_=v(p),g=wo();function v(w){return w&&w.__esModule?w:{default:w}}function m(w,S){var F={};for(var E in w)S.indexOf(E)>=0||Object.prototype.hasOwnProperty.call(w,E)&&(F[E]=w[E]);return F}function b(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function C(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function k(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}function A(w,S){return w.scrollWidth-1<=S}function I(w,S){return w.scrollHeight-1<=S}function M(){}var O=function(w){k(S,w);function S(F){b(this,S);var E=C(this,(S.__proto__||Object.getPrototypeOf(S)).call(this,F));return E.state={fontSize:null,ready:!1},E.handleWindowResize=function(){E.process()},"perfectFit"in F&&console.warn("TextFit property perfectFit has been removed."),E.handleWindowResize=(0,d.default)(E.handleWindowResize,F.throttle),E}return e(S,[{key:"componentDidMount",value:function(){var E=this.props.autoResize;E&&window.addEventListener("resize",this.handleWindowResize),this.process()}},{key:"componentDidUpdate",value:function(E){var P=this.state.ready;P&&((0,l.default)(this.props,E)||this.process())}},{key:"componentWillUnmount",value:function(){var E=this.props.autoResize;E&&window.removeEventListener("resize",this.handleWindowResize),this.pid=(0,_.default)()}},{key:"process",value:function(){var E=this,P=this.props,R=P.min,D=P.max,$=P.mode,V=P.forceSingleModeWidth,me=P.onReady,ye=this._parent,ae=this._child,j=(0,g.innerWidth)(ye),ue=(0,g.innerHeight)(ye);if(ue<=0||isNaN(ue)){console.warn("Can not process element without height. Make sure the element is displayed and has a static height.");return}if(j<=0||isNaN(j)){console.warn("Can not process element without width. Make sure the element is displayed and has a static width.");return}var ze=(0,_.default)();this.pid=ze;var be=function(){return ze!==E.pid},nt=$==="multi"?function(){return I(ae,ue)}:function(){return A(ae,j)},_n=$==="multi"?function(){return A(ae,j)}:function(){return I(ae,ue)},L=void 0,pe=R,ge=D;this.setState({ready:!1}),(0,s.default)([function(ne){return(0,u.default)(function(){return pe<=ge},function(we){if(be())return we(!0);L=parseInt((pe+ge)/2,10),E.setState({fontSize:L},function(){return be()?we(!0):(nt()?pe=L+1:ge=L-1,we())})},ne)},function(ne){return $==="single"&&V||_n()?ne():(pe=R,ge=L,(0,u.default)(function(){return pe<ge},function(we){if(be())return we(!0);L=parseInt((pe+ge)/2,10),E.setState({fontSize:L},function(){return ze!==E.pid?we(!0):(_n()?pe=L+1:ge=L-1,we())})},ne))},function(ne){if(L=Math.min(pe,ge),L=Math.max(L,R),L=Math.min(L,D),L=Math.max(L,0),be())return ne(!0);E.setState({fontSize:L},ne)}],function(ne){ne||be()||E.setState({ready:!0},function(){return me(L)})})}},{key:"render",value:function(){var E=this,P=this.props,R=P.children,D=P.text,$=P.style;P.min,P.max;var V=P.mode;P.forceWidth,P.forceSingleModeWidth,P.throttle,P.autoResize,P.onReady;var me=m(P,["children","text","style","min","max","mode","forceWidth","forceSingleModeWidth","throttle","autoResize","onReady"]),ye=this.state,ae=ye.fontSize,j=ye.ready,ue=r({},$,{fontSize:ae}),ze={display:j?"block":"inline-block"};return V==="single"&&(ze.whiteSpace="nowrap"),t.default.createElement("div",r({ref:function(nt){return E._parent=nt},style:ue},me),t.default.createElement("div",{ref:function(nt){return E._child=nt},style:ze},D&&typeof R=="function"?j?R(D):D:R))}}]),S}(t.default.Component);return O.propTypes={children:o.default.node,text:o.default.string,min:o.default.number,max:o.default.number,mode:o.default.oneOf(["single","multi"]),forceSingleModeWidth:o.default.bool,throttle:o.default.number,onReady:o.default.func},O.defaultProps={min:1,max:100,mode:"multi",forceSingleModeWidth:!0,throttle:50,autoResize:!0,onReady:M},_t.default=O,_t}var In;function So(){if(In)return Ke;In=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.Textfit=void 0;var r=Co(),e=n(r);function n(t){return t&&t.__esModule?t:{default:t}}return Ke.Textfit=e.default,Ke.default=e.default,Ke}var os=So(),Ce={},Se={},ke={};class ve extends Error{constructor(e,n){const t=new.target.prototype;super(`${e}: Status code '${n}'`),this.statusCode=n,this.__proto__=t}}class At extends Error{constructor(e="A timeout occurred."){const n=new.target.prototype;super(e),this.__proto__=n}}class te extends Error{constructor(e="An abort occurred."){const n=new.target.prototype;super(e),this.__proto__=n}}class ko extends Error{constructor(e,n){const t=new.target.prototype;super(e),this.transport=n,this.errorType="UnsupportedTransportError",this.__proto__=t}}class Eo extends Error{constructor(e,n){const t=new.target.prototype;super(e),this.transport=n,this.errorType="DisabledTransportError",this.__proto__=t}}class To extends Error{constructor(e,n){const t=new.target.prototype;super(e),this.transport=n,this.errorType="FailedToStartTransportError",this.__proto__=t}}class On extends Error{constructor(e){const n=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=n}}class Ro extends Error{constructor(e,n){const t=new.target.prototype;super(e),this.innerErrors=n,this.__proto__=t}}class an{constructor(e,n,t){this.statusCode=e,this.statusText=n,this.content=t}}class pt{get(e,n){return this.send({...n,method:"GET",url:e})}post(e,n){return this.send({...n,method:"POST",url:e})}delete(e,n){return this.send({...n,method:"DELETE",url:e})}getCookieString(e){return""}}var y;(function(r){r[r.Trace=0]="Trace",r[r.Debug=1]="Debug",r[r.Information=2]="Information",r[r.Warning=3]="Warning",r[r.Error=4]="Error",r[r.Critical=5]="Critical",r[r.None=6]="None"})(y||(y={}));class Ye{constructor(){}log(e,n){}}Ye.instance=new Ye;const Lr="8.0.7";class B{static isRequired(e,n){if(e==null)throw new Error(`The '${n}' argument is required.`)}static isNotEmpty(e,n){if(!e||e.match(/^\s*$/))throw new Error(`The '${n}' argument should not be empty.`)}static isIn(e,n,t){if(!(e in n))throw new Error(`Unknown ${t} value: ${e}.`)}}class q{static get isBrowser(){return!q.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!q.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!q.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function dt(r,e){let n="";return Ve(r)?(n=`Binary data of length ${r.byteLength}`,e&&(n+=`. Content: '${Po(r)}'`)):typeof r=="string"&&(n=`String data of length ${r.length}`,e&&(n+=`. Content: '${r}'`)),n}function Po(r){const e=new Uint8Array(r);let n="";return e.forEach(t=>{const i=t<16?"0":"";n+=`0x${i}${t.toString(16)} `}),n.substr(0,n.length-1)}function Ve(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}async function Ur(r,e,n,t,i,o){const c={},[l,h]=Ge();c[l]=h,r.log(y.Trace,`(${e} transport) sending data. ${dt(i,o.logMessageContent)}.`);const s=Ve(i)?"arraybuffer":"text",a=await n.post(t,{content:i,headers:{...c,...o.headers},responseType:s,timeout:o.timeout,withCredentials:o.withCredentials});r.log(y.Trace,`(${e} transport) request complete. Response status: ${a.statusCode}.`)}function Io(r){return r===void 0?new Ft(y.Information):r===null?Ye.instance:r.log!==void 0?r:new Ft(r)}class Oo{constructor(e,n){this._subject=e,this._observer=n}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(n=>{})}}class Ft{constructor(e){this._minLevel=e,this.out=console}log(e,n){if(e>=this._minLevel){const t=`[${new Date().toISOString()}] ${y[e]}: ${n}`;switch(e){case y.Critical:case y.Error:this.out.error(t);break;case y.Warning:this.out.warn(t);break;case y.Information:this.out.info(t);break;default:this.out.log(t);break}}}}function Ge(){let r="X-SignalR-User-Agent";return q.isNode&&(r="User-Agent"),[r,Fo(Lr,Ao(),No(),Do())]}function Fo(r,e,n,t){let i="Microsoft SignalR/";const o=r.split(".");return i+=`${o[0]}.${o[1]}`,i+=` (${r}; `,e&&e!==""?i+=`${e}; `:i+="Unknown OS; ",i+=`${n}`,t?i+=`; ${t}`:i+="; Unknown Runtime Version",i+=")",i}function Ao(){if(q.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function Do(){if(q.isNode)return process.versions.node}function No(){return q.isNode?"NodeJS":"Browser"}function Ht(r){return r.stack?r.stack:r.message?r.message:`${r}`}function qo(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}class Mo extends pt{constructor(e){if(super(),this._logger=e,typeof fetch>"u"||q.isNode){const n=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(n("tough-cookie")).CookieJar,typeof fetch>"u"?this._fetchType=n("node-fetch"):this._fetchType=fetch,this._fetchType=n("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(qo());if(typeof AbortController>"u"){const n=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=n("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new te;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const n=new this._abortControllerType;let t;e.abortSignal&&(e.abortSignal.onabort=()=>{n.abort(),t=new te});let i=null;if(e.timeout){const h=e.timeout;i=setTimeout(()=>{n.abort(),this._logger.log(y.Warning,"Timeout from HTTP request."),t=new At},h)}e.content===""&&(e.content=void 0),e.content&&(e.headers=e.headers||{},Ve(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");let o;try{o=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:n.signal})}catch(h){throw t||(this._logger.log(y.Warning,`Error from HTTP request. ${h}.`),h)}finally{i&&clearTimeout(i),e.abortSignal&&(e.abortSignal.onabort=null)}if(!o.ok){const h=await Fn(o,"text");throw new ve(h||o.statusText,o.status)}const l=await Fn(o,e.responseType);return new an(o.status,o.statusText,l)}getCookieString(e){let n="";return q.isNode&&this._jar&&this._jar.getCookies(e,(t,i)=>n=i.join("; ")),n}}function Fn(r,e){let n;switch(e){case"arraybuffer":n=r.arrayBuffer();break;case"text":n=r.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:n=r.text();break}return n}class jo extends pt{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new te):e.method?e.url?new Promise((n,t)=>{const i=new XMLHttpRequest;i.open(e.method,e.url,!0),i.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.content===""&&(e.content=void 0),e.content&&(Ve(e.content)?i.setRequestHeader("Content-Type","application/octet-stream"):i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const o=e.headers;o&&Object.keys(o).forEach(c=>{i.setRequestHeader(c,o[c])}),e.responseType&&(i.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),t(new te)}),e.timeout&&(i.timeout=e.timeout),i.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),i.status>=200&&i.status<300?n(new an(i.status,i.statusText,i.response||i.responseText)):t(new ve(i.response||i.responseText||i.statusText,i.status))},i.onerror=()=>{this._logger.log(y.Warning,`Error from HTTP request. ${i.status}: ${i.statusText}.`),t(new ve(i.statusText,i.status))},i.ontimeout=()=>{this._logger.log(y.Warning,"Timeout from HTTP request."),t(new At)},i.send(e.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Wr extends pt{constructor(e){if(super(),typeof fetch<"u"||q.isNode)this._httpClient=new Mo(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new jo(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new te):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class Z{static write(e){return`${e}${Z.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Z.RecordSeparator)throw new Error("Message is incomplete.");const n=e.split(Z.RecordSeparator);return n.pop(),n}}Z.RecordSeparatorCode=30;Z.RecordSeparator=String.fromCharCode(Z.RecordSeparatorCode);class xo{writeHandshakeRequest(e){return Z.write(JSON.stringify(e))}parseHandshakeResponse(e){let n,t;if(Ve(e)){const l=new Uint8Array(e),h=l.indexOf(Z.RecordSeparatorCode);if(h===-1)throw new Error("Message is incomplete.");const s=h+1;n=String.fromCharCode.apply(null,Array.prototype.slice.call(l.slice(0,s))),t=l.byteLength>s?l.slice(s).buffer:null}else{const l=e,h=l.indexOf(Z.RecordSeparator);if(h===-1)throw new Error("Message is incomplete.");const s=h+1;n=l.substring(0,s),t=l.length>s?l.substring(s):null}const i=Z.parse(n),o=JSON.parse(i[0]);if(o.type)throw new Error("Expected a handshake response from the server.");return[t,o]}}var T;(function(r){r[r.Invocation=1]="Invocation",r[r.StreamItem=2]="StreamItem",r[r.Completion=3]="Completion",r[r.StreamInvocation=4]="StreamInvocation",r[r.CancelInvocation=5]="CancelInvocation",r[r.Ping=6]="Ping",r[r.Close=7]="Close",r[r.Ack=8]="Ack",r[r.Sequence=9]="Sequence"})(T||(T={}));class Hr{constructor(){this.observers=[]}next(e){for(const n of this.observers)n.next(e)}error(e){for(const n of this.observers)n.error&&n.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new Oo(this,e)}}class Bo{constructor(e,n,t){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=e,this._connection=n,this._bufferSize=t}async _send(e){const n=this._protocol.writeMessage(e);let t=Promise.resolve();if(this._isInvocationMessage(e)){this._totalMessageCount++;let i=()=>{},o=()=>{};Ve(n)?this._bufferedByteCount+=n.byteLength:this._bufferedByteCount+=n.length,this._bufferedByteCount>=this._bufferSize&&(t=new Promise((c,l)=>{i=c,o=l})),this._messages.push(new $o(n,this._totalMessageCount,i,o))}try{this._reconnectInProgress||await this._connection.send(n)}catch{this._disconnected()}await t}_ack(e){let n=-1;for(let t=0;t<this._messages.length;t++){const i=this._messages[t];if(i._id<=e.sequenceId)n=t,Ve(i._message)?this._bufferedByteCount-=i._message.byteLength:this._bufferedByteCount-=i._message.length,i._resolver();else if(this._bufferedByteCount<this._bufferSize)i._resolver();else break}n!==-1&&(this._messages=this._messages.slice(n+1))}_shouldProcessMessage(e){if(this._waitForSequenceMessage)return e.type!==T.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(e))return!0;const n=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,n<=this._latestReceivedSequenceId?(n===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=n,this._ackTimer(),!0)}_resetSequence(e){if(e.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=e.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const e=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:T.Sequence,sequenceId:e}));const n=this._messages;for(const t of n)await this._connection.send(t._message);this._reconnectInProgress=!1}_dispose(e){e??(e=new Error("Unable to reconnect to server."));for(const n of this._messages)n._rejector(e)}_isInvocationMessage(e){switch(e.type){case T.Invocation:case T.StreamItem:case T.Completion:case T.StreamInvocation:case T.CancelInvocation:return!0;case T.Close:case T.Sequence:case T.Ping:case T.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:T.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class $o{constructor(e,n,t,i){this._message=e,this._id=n,this._resolver=t,this._rejector=i}}const Lo=30*1e3,Uo=15*1e3,Wo=1e5;var N;(function(r){r.Disconnected="Disconnected",r.Connecting="Connecting",r.Connected="Connected",r.Disconnecting="Disconnecting",r.Reconnecting="Reconnecting"})(N||(N={}));class Dt{static create(e,n,t,i,o,c,l){return new Dt(e,n,t,i,o,c,l)}constructor(e,n,t,i,o,c,l){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(y.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},B.isRequired(e,"connection"),B.isRequired(n,"logger"),B.isRequired(t,"protocol"),this.serverTimeoutInMilliseconds=o??Lo,this.keepAliveIntervalInMilliseconds=c??Uo,this._statefulReconnectBufferSize=l??Wo,this._logger=n,this._protocol=t,this.connection=e,this._reconnectPolicy=i,this._handshakeProtocol=new xo,this.connection.onreceive=h=>this._processIncomingData(h),this.connection.onclose=h=>this._connectionClosed(h),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=N.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:T.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==N.Disconnected&&this._connectionState!==N.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==N.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=N.Connecting,this._logger.log(y.Debug,"Starting HubConnection.");try{await this._startInternal(),q.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=N.Connected,this._connectionStarted=!0,this._logger.log(y.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=N.Disconnected,this._logger.log(y.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((n,t)=>{this._handshakeResolver=n,this._handshakeRejecter=t});await this.connection.start(this._protocol.transferFormat);try{let n=this._protocol.version;this.connection.features.reconnect||(n=1);const t={protocol:this._protocol.name,version:n};if(this._logger.log(y.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(t)),this._logger.log(y.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new Bo(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(n){throw this._logger.log(y.Debug,`Hub handshake failed with error '${n}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(n),n}}async stop(){const e=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){if(this._connectionState===N.Disconnected)return this._logger.log(y.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===N.Disconnecting)return this._logger.log(y.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const n=this._connectionState;return this._connectionState=N.Disconnecting,this._logger.log(y.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(y.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(n===N.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new te("The connection was stopped before the hub handshake could complete."),this.connection.stop(e))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(e,...n){const[t,i]=this._replaceStreamingParams(n),o=this._createStreamInvocation(e,n,i);let c;const l=new Hr;return l.cancelCallback=()=>{const h=this._createCancelInvocation(o.invocationId);return delete this._callbacks[o.invocationId],c.then(()=>this._sendWithProtocol(h))},this._callbacks[o.invocationId]=(h,s)=>{if(s){l.error(s);return}else h&&(h.type===T.Completion?h.error?l.error(new Error(h.error)):l.complete():l.next(h.item))},c=this._sendWithProtocol(o).catch(h=>{l.error(h),delete this._callbacks[o.invocationId]}),this._launchStreams(t,c),l}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._messageBuffer?this._messageBuffer._send(e):this._sendMessage(this._protocol.writeMessage(e))}send(e,...n){const[t,i]=this._replaceStreamingParams(n),o=this._sendWithProtocol(this._createInvocation(e,n,!0,i));return this._launchStreams(t,o),o}invoke(e,...n){const[t,i]=this._replaceStreamingParams(n),o=this._createInvocation(e,n,!1,i);return new Promise((l,h)=>{this._callbacks[o.invocationId]=(a,u)=>{if(u){h(u);return}else a&&(a.type===T.Completion?a.error?h(new Error(a.error)):l(a.result):h(new Error(`Unexpected message type: ${a.type}`)))};const s=this._sendWithProtocol(o).catch(a=>{h(a),delete this._callbacks[o.invocationId]});this._launchStreams(t,s)})}on(e,n){!e||!n||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(n)===-1&&this._methods[e].push(n))}off(e,n){if(!e)return;e=e.toLowerCase();const t=this._methods[e];if(t)if(n){const i=t.indexOf(n);i!==-1&&(t.splice(i,1),t.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const n=this._protocol.parseMessages(e,this._logger);for(const t of n)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(t)))switch(t.type){case T.Invocation:this._invokeClientMethod(t).catch(i=>{this._logger.log(y.Error,`Invoke client method threw error: ${Ht(i)}`)});break;case T.StreamItem:case T.Completion:{const i=this._callbacks[t.invocationId];if(i){t.type===T.Completion&&delete this._callbacks[t.invocationId];try{i(t)}catch(o){this._logger.log(y.Error,`Stream callback threw error: ${Ht(o)}`)}}break}case T.Ping:break;case T.Close:{this._logger.log(y.Information,"Close message received from server.");const i=t.error?new Error("Server returned an error on close: "+t.error):void 0;t.allowReconnect===!0?this.connection.stop(i):this._stopPromise=this._stopInternal(i);break}case T.Ack:this._messageBuffer&&this._messageBuffer._ack(t);break;case T.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(t);break;default:this._logger.log(y.Warning,`Invalid message type: ${t.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let n,t;try{[t,n]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(i){const o="Error parsing handshake response: "+i;this._logger.log(y.Error,o);const c=new Error(o);throw this._handshakeRejecter(c),c}if(n.error){const i="Server returned handshake error: "+n.error;this._logger.log(y.Error,i);const o=new Error(i);throw this._handshakeRejecter(o),o}else this._logger.log(y.Debug,"Server handshake complete.");return this._handshakeResolver(),t}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===N.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const n=e.target.toLowerCase(),t=this._methods[n];if(!t){this._logger.log(y.Warning,`No client method with the name '${n}' found.`),e.invocationId&&(this._logger.log(y.Warning,`No result given for '${n}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)));return}const i=t.slice(),o=!!e.invocationId;let c,l,h;for(const s of i)try{const a=c;c=await s.apply(this,e.arguments),o&&c&&a&&(this._logger.log(y.Error,`Multiple results provided for '${n}'. Sending error to server.`),h=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),l=void 0}catch(a){l=a,this._logger.log(y.Error,`A callback for the method '${n}' threw error '${a}'.`)}h?await this._sendWithProtocol(h):o?(l?h=this._createCompletionMessage(e.invocationId,`${l}`,null):c!==void 0?h=this._createCompletionMessage(e.invocationId,null,c):(this._logger.log(y.Warning,`No result given for '${n}' method and invocation ID '${e.invocationId}'.`),h=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(h)):c&&this._logger.log(y.Error,`Result given for '${n}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(y.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new te("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===N.Disconnecting?this._completeClose(e):this._connectionState===N.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===N.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=N.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(e??new Error("Connection closed.")),this._messageBuffer=void 0),q.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(n=>n.apply(this,[e]))}catch(n){this._logger.log(y.Error,`An onclose callback called with error '${e}' threw error '${n}'.`)}}}async _reconnect(e){const n=Date.now();let t=0,i=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),o=this._getNextRetryDelay(t++,0,i);if(o===null){this._logger.log(y.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=N.Reconnecting,e?this._logger.log(y.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(y.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(c=>c.apply(this,[e]))}catch(c){this._logger.log(y.Error,`An onreconnecting callback called with error '${e}' threw error '${c}'.`)}if(this._connectionState!==N.Reconnecting){this._logger.log(y.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;o!==null;){if(this._logger.log(y.Information,`Reconnect attempt number ${t} will start in ${o} ms.`),await new Promise(c=>{this._reconnectDelayHandle=setTimeout(c,o)}),this._reconnectDelayHandle=void 0,this._connectionState!==N.Reconnecting){this._logger.log(y.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=N.Connected,this._logger.log(y.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(c=>c.apply(this,[this.connection.connectionId]))}catch(c){this._logger.log(y.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${c}'.`)}return}catch(c){if(this._logger.log(y.Information,`Reconnect attempt failed because of error '${c}'.`),this._connectionState!==N.Reconnecting){this._logger.log(y.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===N.Disconnecting&&this._completeClose();return}i=c instanceof Error?c:new Error(c.toString()),o=this._getNextRetryDelay(t++,Date.now()-n,i)}}this._logger.log(y.Information,`Reconnect retries have been exhausted after ${Date.now()-n} ms and ${t} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,n,t){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:n,previousRetryCount:e,retryReason:t})}catch(i){return this._logger.log(y.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${n}) threw error '${i}'.`),null}}_cancelCallbacksWithError(e){const n=this._callbacks;this._callbacks={},Object.keys(n).forEach(t=>{const i=n[t];try{i(null,e)}catch(o){this._logger.log(y.Error,`Stream 'error' callback called with '${e}' threw error: ${Ht(o)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,n,t,i){if(t)return i.length!==0?{arguments:n,streamIds:i,target:e,type:T.Invocation}:{arguments:n,target:e,type:T.Invocation};{const o=this._invocationId;return this._invocationId++,i.length!==0?{arguments:n,invocationId:o.toString(),streamIds:i,target:e,type:T.Invocation}:{arguments:n,invocationId:o.toString(),target:e,type:T.Invocation}}}_launchStreams(e,n){if(e.length!==0){n||(n=Promise.resolve());for(const t in e)e[t].subscribe({complete:()=>{n=n.then(()=>this._sendWithProtocol(this._createCompletionMessage(t)))},error:i=>{let o;i instanceof Error?o=i.message:i&&i.toString?o=i.toString():o="Unknown error",n=n.then(()=>this._sendWithProtocol(this._createCompletionMessage(t,o)))},next:i=>{n=n.then(()=>this._sendWithProtocol(this._createStreamItemMessage(t,i)))}})}}_replaceStreamingParams(e){const n=[],t=[];for(let i=0;i<e.length;i++){const o=e[i];if(this._isObservable(o)){const c=this._invocationId;this._invocationId++,n[c]=o,t.push(c.toString()),e.splice(i,1)}}return[n,t]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,n,t){const i=this._invocationId;return this._invocationId++,t.length!==0?{arguments:n,invocationId:i.toString(),streamIds:t,target:e,type:T.StreamInvocation}:{arguments:n,invocationId:i.toString(),target:e,type:T.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:T.CancelInvocation}}_createStreamItemMessage(e,n){return{invocationId:e,item:n,type:T.StreamItem}}_createCompletionMessage(e,n,t){return n?{error:n,invocationId:e,type:T.Completion}:{invocationId:e,result:t,type:T.Completion}}_createCloseMessage(){return{type:T.Close}}}const Ho=[0,2e3,1e4,3e4,null];class An{constructor(e){this._retryDelays=e!==void 0?[...e,null]:Ho}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class He{}He.Authorization="Authorization";He.Cookie="Cookie";class Vo extends pt{constructor(e,n){super(),this._innerClient=e,this._accessTokenFactory=n}async send(e){let n=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(n=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const t=await this._innerClient.send(e);return n&&t.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):t}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[He.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[He.Authorization]&&delete e.headers[He.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var x;(function(r){r[r.None=0]="None",r[r.WebSockets=1]="WebSockets",r[r.ServerSentEvents=2]="ServerSentEvents",r[r.LongPolling=4]="LongPolling"})(x||(x={}));var H;(function(r){r[r.Text=1]="Text",r[r.Binary=2]="Binary"})(H||(H={}));let zo=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class Dn{get pollAborted(){return this._pollAbort.aborted}constructor(e,n,t){this._httpClient=e,this._logger=n,this._pollAbort=new zo,this._options=t,this._running=!1,this.onreceive=null,this.onclose=null}async connect(e,n){if(B.isRequired(e,"url"),B.isRequired(n,"transferFormat"),B.isIn(n,H,"transferFormat"),this._url=e,this._logger.log(y.Trace,"(LongPolling transport) Connecting."),n===H.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[t,i]=Ge(),o={[t]:i,...this._options.headers},c={abortSignal:this._pollAbort.signal,headers:o,timeout:1e5,withCredentials:this._options.withCredentials};n===H.Binary&&(c.responseType="arraybuffer");const l=`${e}&_=${Date.now()}`;this._logger.log(y.Trace,`(LongPolling transport) polling: ${l}.`);const h=await this._httpClient.get(l,c);h.statusCode!==200?(this._logger.log(y.Error,`(LongPolling transport) Unexpected response code: ${h.statusCode}.`),this._closeError=new ve(h.statusText||"",h.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,c)}async _poll(e,n){try{for(;this._running;)try{const t=`${e}&_=${Date.now()}`;this._logger.log(y.Trace,`(LongPolling transport) polling: ${t}.`);const i=await this._httpClient.get(t,n);i.statusCode===204?(this._logger.log(y.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):i.statusCode!==200?(this._logger.log(y.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this._closeError=new ve(i.statusText||"",i.statusCode),this._running=!1):i.content?(this._logger.log(y.Trace,`(LongPolling transport) data received. ${dt(i.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(i.content)):this._logger.log(y.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(t){this._running?t instanceof At?this._logger.log(y.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=t,this._running=!1):this._logger.log(y.Trace,`(LongPolling transport) Poll errored after shutdown: ${t.message}`)}}finally{this._logger.log(y.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?Ur(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(y.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(y.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[n,t]=Ge();e[n]=t;const i={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let o;try{await this._httpClient.delete(this._url,i)}catch(c){o=c}o?o instanceof ve&&(o.statusCode===404?this._logger.log(y.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(y.Trace,`(LongPolling transport) Error sending a DELETE request: ${o}`)):this._logger.log(y.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(y.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(y.Trace,e),this.onclose(this._closeError)}}}class Ko{constructor(e,n,t,i){this._httpClient=e,this._accessToken=n,this._logger=t,this._options=i,this.onreceive=null,this.onclose=null}async connect(e,n){return B.isRequired(e,"url"),B.isRequired(n,"transferFormat"),B.isIn(n,H,"transferFormat"),this._logger.log(y.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((t,i)=>{let o=!1;if(n!==H.Text){i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let c;if(q.isBrowser||q.isWebWorker)c=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const l=this._httpClient.getCookieString(e),h={};h.Cookie=l;const[s,a]=Ge();h[s]=a,c=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...h,...this._options.headers}})}try{c.onmessage=l=>{if(this.onreceive)try{this._logger.log(y.Trace,`(SSE transport) data received. ${dt(l.data,this._options.logMessageContent)}.`),this.onreceive(l.data)}catch(h){this._close(h);return}},c.onerror=l=>{o?this._close():i(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},c.onopen=()=>{this._logger.log(y.Information,`SSE connected to ${this._url}`),this._eventSource=c,o=!0,t()}}catch(l){i(l);return}})}async send(e){return this._eventSource?Ur(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Xo{constructor(e,n,t,i,o,c){this._logger=t,this._accessTokenFactory=n,this._logMessageContent=i,this._webSocketConstructor=o,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=c}async connect(e,n){B.isRequired(e,"url"),B.isRequired(n,"transferFormat"),B.isIn(n,H,"transferFormat"),this._logger.log(y.Trace,"(WebSockets transport) Connecting.");let t;return this._accessTokenFactory&&(t=await this._accessTokenFactory()),new Promise((i,o)=>{e=e.replace(/^http/,"ws");let c;const l=this._httpClient.getCookieString(e);let h=!1;if(q.isNode||q.isReactNative){const s={},[a,u]=Ge();s[a]=u,t&&(s[He.Authorization]=`Bearer ${t}`),l&&(s[He.Cookie]=l),c=new this._webSocketConstructor(e,void 0,{headers:{...s,...this._headers}})}else t&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(t)}`);c||(c=new this._webSocketConstructor(e)),n===H.Binary&&(c.binaryType="arraybuffer"),c.onopen=s=>{this._logger.log(y.Information,`WebSocket connected to ${e}.`),this._webSocket=c,h=!0,i()},c.onerror=s=>{let a=null;typeof ErrorEvent<"u"&&s instanceof ErrorEvent?a=s.error:a="There was an error with the transport",this._logger.log(y.Information,`(WebSockets transport) ${a}.`)},c.onmessage=s=>{if(this._logger.log(y.Trace,`(WebSockets transport) data received. ${dt(s.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(s.data)}catch(a){this._close(a);return}},c.onclose=s=>{if(h)this._close(s);else{let a=null;typeof ErrorEvent<"u"&&s instanceof ErrorEvent?a=s.error:a="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",o(new Error(a))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(y.Trace,`(WebSockets transport) sending data. ${dt(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(y.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose())}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}const Nn=100;class Jo{constructor(e,n={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,B.isRequired(e,"url"),this._logger=Io(n.logger),this.baseUrl=this._resolveUrl(e),n=n||{},n.logMessageContent=n.logMessageContent===void 0?!1:n.logMessageContent,typeof n.withCredentials=="boolean"||n.withCredentials===void 0)n.withCredentials=n.withCredentials===void 0?!0:n.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");n.timeout=n.timeout===void 0?100*1e3:n.timeout;let t=null,i=null;if(q.isNode&&typeof require<"u"){const o=typeof __webpack_require__=="function"?__non_webpack_require__:require;t=o("ws"),i=o("eventsource")}!q.isNode&&typeof WebSocket<"u"&&!n.WebSocket?n.WebSocket=WebSocket:q.isNode&&!n.WebSocket&&t&&(n.WebSocket=t),!q.isNode&&typeof EventSource<"u"&&!n.EventSource?n.EventSource=EventSource:q.isNode&&!n.EventSource&&typeof i<"u"&&(n.EventSource=i),this._httpClient=new Vo(n.httpClient||new Wr(this._logger),n.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=n,this.onreceive=null,this.onclose=null}async start(e){if(e=e||H.Binary,B.isIn(e,H,"transferFormat"),this._logger.log(y.Debug,`Starting connection with transfer format '${H[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const n="Failed to start the HttpConnection before stop() was called.";return this._logger.log(y.Error,n),await this._stopPromise,Promise.reject(new te(n))}else if(this._connectionState!=="Connected"){const n="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(y.Error,n),Promise.reject(new te(n))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new un(this.transport)),this._sendQueue.send(e))}async stop(e){if(this._connectionState==="Disconnected")return this._logger.log(y.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(y.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(n=>{this._stopPromiseResolver=n}),await this._stopInternal(e),await this._stopPromise}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(n){this._logger.log(y.Error,`HttpConnection.transport.stop() threw error '${n}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(y.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let n=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===x.WebSockets)this.transport=this._constructTransport(x.WebSockets),await this._startTransport(n,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let t=null,i=0;do{if(t=await this._getNegotiationResponse(n),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new te("The connection was stopped during negotiation.");if(t.error)throw new Error(t.error);if(t.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(t.url&&(n=t.url),t.accessToken){const o=t.accessToken;this._accessTokenFactory=()=>o,this._httpClient._accessToken=o,this._httpClient._accessTokenFactory=void 0}i++}while(t.url&&i<Nn);if(i===Nn&&t.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(n,this._options.transport,t,e)}this.transport instanceof Dn&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(y.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(t){return this._logger.log(y.Error,"Failed to start the connection: "+t),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(t)}}async _getNegotiationResponse(e){const n={},[t,i]=Ge();n[t]=i;const o=this._resolveNegotiateUrl(e);this._logger.log(y.Debug,`Sending negotiation request: ${o}.`);try{const c=await this._httpClient.post(o,{content:"",headers:{...n,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(c.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${c.statusCode}'`));const l=JSON.parse(c.content);return(!l.negotiateVersion||l.negotiateVersion<1)&&(l.connectionToken=l.connectionId),l.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new On("Client didn't negotiate Stateful Reconnect but the server did.")):l}catch(c){let l="Failed to complete negotiation with the server: "+c;return c instanceof ve&&c.statusCode===404&&(l=l+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(y.Error,l),Promise.reject(new On(l))}}_createConnectUrl(e,n){return n?e+(e.indexOf("?")===-1?"?":"&")+`id=${n}`:e}async _createTransport(e,n,t,i){let o=this._createConnectUrl(e,t.connectionToken);if(this._isITransport(n)){this._logger.log(y.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=n,await this._startTransport(o,i),this.connectionId=t.connectionId;return}const c=[],l=t.availableTransports||[];let h=t;for(const s of l){const a=this._resolveTransportOrError(s,n,i,(h==null?void 0:h.useStatefulReconnect)===!0);if(a instanceof Error)c.push(`${s.transport} failed:`),c.push(a);else if(this._isITransport(a)){if(this.transport=a,!h){try{h=await this._getNegotiationResponse(e)}catch(u){return Promise.reject(u)}o=this._createConnectUrl(e,h.connectionToken)}try{await this._startTransport(o,i),this.connectionId=h.connectionId;return}catch(u){if(this._logger.log(y.Error,`Failed to start the transport '${s.transport}': ${u}`),h=void 0,c.push(new To(`${s.transport} failed: ${u}`,x[s.transport])),this._connectionState!=="Connecting"){const f="Failed to select transport before stop() was called.";return this._logger.log(y.Debug,f),Promise.reject(new te(f))}}}}return c.length>0?Promise.reject(new Ro(`Unable to connect to the server with any of the available transports. ${c.join(" ")}`,c)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case x.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Xo(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case x.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Ko(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case x.LongPolling:return new Dn(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,n){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async t=>{let i=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(e,n),await this.features.resend()}catch{i=!0}else{this._stopConnection(t);return}i&&this._stopConnection(t)}:this.transport.onclose=t=>this._stopConnection(t),this.transport.connect(e,n)}_resolveTransportOrError(e,n,t,i){const o=x[e.transport];if(o==null)return this._logger.log(y.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(Yo(n,o))if(e.transferFormats.map(l=>H[l]).indexOf(t)>=0){if(o===x.WebSockets&&!this._options.WebSocket||o===x.ServerSentEvents&&!this._options.EventSource)return this._logger.log(y.Debug,`Skipping transport '${x[o]}' because it is not supported in your environment.'`),new ko(`'${x[o]}' is not supported in your environment.`,o);this._logger.log(y.Debug,`Selecting transport '${x[o]}'.`);try{return this.features.reconnect=o===x.WebSockets?i:void 0,this._constructTransport(o)}catch(l){return l}}else return this._logger.log(y.Debug,`Skipping transport '${x[o]}' because it does not support the requested transfer format '${H[t]}'.`),new Error(`'${x[o]}' does not support ${H[t]}.`);else return this._logger.log(y.Debug,`Skipping transport '${x[o]}' because it was disabled by the client.`),new Eo(`'${x[o]}' is disabled by the client.`,o)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(y.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(y.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(y.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(y.Error,`Connection disconnected with error '${e}'.`):this._logger.log(y.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(n=>{this._logger.log(y.Error,`TransportSendQueue.stop() threw error '${n}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(n){this._logger.log(y.Error,`HttpConnection.onclose(${e}) threw error '${n}'.`)}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!q.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const n=window.document.createElement("a");return n.href=e,this._logger.log(y.Information,`Normalizing '${e}' to '${n.href}'.`),n.href}_resolveNegotiateUrl(e){const n=new URL(e);n.pathname.endsWith("/")?n.pathname+="negotiate":n.pathname+="/negotiate";const t=new URLSearchParams(n.searchParams);return t.has("negotiateVersion")||t.append("negotiateVersion",this._negotiateVersion.toString()),t.has("useStatefulReconnect")?t.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&t.append("useStatefulReconnect","true"),n.search=t.toString(),n.toString()}}function Yo(r,e){return!r||(e&r)!==0}class un{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new Ct,this._transportResult=new Ct,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new Ct),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Ct;const e=this._transportResult;this._transportResult=void 0;const n=typeof this._buffer[0]=="string"?this._buffer.join(""):un._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(n),e.resolve()}catch(t){e.reject(t)}}}static _concatBuffers(e){const n=e.map(o=>o.byteLength).reduce((o,c)=>o+c),t=new Uint8Array(n);let i=0;for(const o of e)t.set(new Uint8Array(o),i),i+=o.byteLength;return t.buffer}}class Ct{constructor(){this.promise=new Promise((e,n)=>[this._resolver,this._rejecter]=[e,n])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}const Go="json";class Vr{constructor(){this.name=Go,this.version=2,this.transferFormat=H.Text}parseMessages(e,n){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];n===null&&(n=Ye.instance);const t=Z.parse(e),i=[];for(const o of t){const c=JSON.parse(o);if(typeof c.type!="number")throw new Error("Invalid payload.");switch(c.type){case T.Invocation:this._isInvocationMessage(c);break;case T.StreamItem:this._isStreamItemMessage(c);break;case T.Completion:this._isCompletionMessage(c);break;case T.Ping:break;case T.Close:break;case T.Ack:this._isAckMessage(c);break;case T.Sequence:this._isSequenceMessage(c);break;default:n.log(y.Information,"Unknown message type '"+c.type+"' ignored.");continue}i.push(c)}return i}writeMessage(e){return Z.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_isAckMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(e){if(typeof e.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(e,n){if(typeof e!="string"||e==="")throw new Error(n)}}const Qo={trace:y.Trace,debug:y.Debug,info:y.Information,information:y.Information,warn:y.Warning,warning:y.Warning,error:y.Error,critical:y.Critical,none:y.None};function Zo(r){const e=Qo[r.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${r}`)}class ei{configureLogging(e){if(B.isRequired(e,"logging"),ti(e))this.logger=e;else if(typeof e=="string"){const n=Zo(e);this.logger=new Ft(n)}else this.logger=new Ft(e);return this}withUrl(e,n){return B.isRequired(e,"url"),B.isNotEmpty(e,"url"),this.url=e,typeof n=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...n}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:n},this}withHubProtocol(e){return B.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new An(e):this.reconnectPolicy=e:this.reconnectPolicy=new An,this}withServerTimeout(e){return B.isRequired(e,"milliseconds"),this._serverTimeoutInMilliseconds=e,this}withKeepAliveInterval(e){return B.isRequired(e,"milliseconds"),this._keepAliveIntervalInMilliseconds=e,this}withStatefulReconnect(e){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=e==null?void 0:e.bufferSize,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const n=new Jo(this.url,e);return Dt.create(n,this.logger||Ye.instance,this.protocol||new Vr,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function ti(r){return r.log!==void 0}const ni=Object.freeze(Object.defineProperty({__proto__:null,AbortError:te,DefaultHttpClient:Wr,HttpClient:pt,HttpError:ve,HttpResponse:an,get HttpTransportType(){return x},HubConnection:Dt,HubConnectionBuilder:ei,get HubConnectionState(){return N},JsonHubProtocol:Vr,get LogLevel(){return y},get MessageType(){return T},NullLogger:Ye,Subject:Hr,TimeoutError:At,get TransferFormat(){return H},VERSION:Lr},Symbol.toStringTag,{value:"Module"})),zr=cn(ni);var St={},qn;function ce(){if(qn)return St;qn=1,Object.defineProperty(St,"__esModule",{value:!0});function r(){const n={};function t(s,a){s in n||(n[s]=[]),n[s].push(a)}function i(s,a){if(s in n){if(typeof a=="function"){const u=n[s].indexOf(a);n[s].splice(u,1)}(typeof a!="function"||n[s].length===0)&&delete n[s]}}function o(s,a){s in n&&n[s].forEach(u=>u(a))}function c(){const s=new BroadcastChannel("hermes");return s.onmessage=u=>o(u.data.topic,u.data.data),{on:t,off:i,send:(u,f,d="other")=>{(d==="all"||d==="other")&&s.postMessage({topic:u,data:f}),(d==="all"||d==="current")&&o(u,f)}}}function l(){const s=window.localStorage,a="__hermes:",u={},f=(d,p,_="other")=>{const g=a+d;s.getItem(g)===null||s.getItem(g)===""?((_==="all"||_==="other")&&(s.setItem(g,JSON.stringify(p)),s.removeItem(g)),(_==="all"||_==="current")&&o(d,p)):(g in u||(u[g]=[]),u[g].push(p))};return window.addEventListener("storage",d=>{if(d.key&&d.key.indexOf(a)===0&&(d.oldValue===null||d.oldValue==="")){const p=d.key.replace(a,""),_=d.newValue?JSON.parse(d.newValue):d.newValue;o(p,_)}}),window.addEventListener("storage",d=>{if(d.key&&d.key.indexOf(a)===0&&(d.newValue===null||d.newValue==="")){const p=d.key.replace(a,"");p in u&&(f(p,u[p].shift()),u[p].length===0&&delete u[p])}}),{on:t,off:i,send:f}}function h(){return{on:t,off:i,send:(a,u,f="other")=>{f!=="other"&&(f==="all"||f==="current")&&o(a,u)}}}if(typeof window<"u"){if("BroadcastChannel"in window)return c();if("localStorage"in window)return l()}return h()}var e=r();return St.default=e,St}var G={},Mn;function ee(){if(Mn)return G;Mn=1;var r=G&&G.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(G,"__esModule",{value:!0}),G.__DEV__=G.useEvent=G.sendWithHermes=G.removeDuplicates=void 0;const e=r(ce()),n=ie(),t=!1;G.__DEV__=t;function i(l){const s=new Set(l).values();return Array.from(s)}G.removeDuplicates=i;function o(l,h,s){e.default.send(l,h,s?"all":"current")}G.sendWithHermes=o;function c(l){const h=(0,n.useRef)(l);h.current!==l&&(h.current=l);const s=(0,n.useCallback)((...a)=>h.current(...a),[]);return l&&s}return G.useEvent=c,G}var Ee={},jn;function ri(){if(jn)return Ee;jn=1;var r=Ee&&Ee.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.createUseSignalREffect=void 0;const e=r(ce()),n=ie(),t=ee();function i(o){return(l,h)=>{const s=(0,t.useEvent)(h);(0,n.useEffect)(()=>{var a;function u(f){s(...f)}return(a=o.on)===null||a===void 0||a.call(o,l),e.default.on(l,u),()=>{var f;(f=o.off)===null||f===void 0||f.call(o,l),e.default.off(l,u)}},[])}}return Ee.createUseSignalREffect=i,Ee}var Te={},Vt={exports:{}};/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */var xn;function ln(){return xn||(xn=1,function(r,e){(function(n){var t;if(r.exports=n(),t=!0,!t){var i=window.Cookies,o=window.Cookies=n();o.noConflict=function(){return window.Cookies=i,o}}})(function(){function n(){for(var o=0,c={};o<arguments.length;o++){var l=arguments[o];for(var h in l)c[h]=l[h]}return c}function t(o){return o.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function i(o){function c(){}function l(s,a,u){if(!(typeof document>"u")){u=n({path:"/"},c.defaults,u),typeof u.expires=="number"&&(u.expires=new Date(new Date*1+u.expires*864e5)),u.expires=u.expires?u.expires.toUTCString():"";try{var f=JSON.stringify(a);/^[\{\[]/.test(f)&&(a=f)}catch{}a=o.write?o.write(a,s):encodeURIComponent(String(a)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),s=encodeURIComponent(String(s)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var d="";for(var p in u)u[p]&&(d+="; "+p,u[p]!==!0&&(d+="="+u[p].split(";")[0]));return document.cookie=s+"="+a+d}}function h(s,a){if(!(typeof document>"u")){for(var u={},f=document.cookie?document.cookie.split("; "):[],d=0;d<f.length;d++){var p=f[d].split("="),_=p.slice(1).join("=");!a&&_.charAt(0)==='"'&&(_=_.slice(1,-1));try{var g=t(p[0]);if(_=(o.read||o)(_,g)||t(_),a)try{_=JSON.parse(_)}catch{}if(u[g]=_,s===g)break}catch{}}return s?u[s]:u}}return c.set=l,c.get=function(s){return h(s,!1)},c.getJSON=function(s){return h(s,!0)},c.remove=function(s,a){l(s,"",n(a,{expires:-1}))},c.defaults={},c.withConverter=i,c}return i(function(){})})}(Vt)),Vt.exports}var Re={},Bn;function Kr(){if(Bn)return Re;Bn=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.createConnection=Re.isConnectionConnecting=void 0;const r=zr;function e(t){return t.state===r.HubConnectionState.Connected||t.state===r.HubConnectionState.Reconnecting||t.state===r.HubConnectionState.Connecting}Re.isConnectionConnecting=e;function n(t,i,o=!0){let c=new r.HubConnectionBuilder().withUrl(t,i);return o&&(Array.isArray(o)?c=c.withAutomaticReconnect(o):c=c.withAutomaticReconnect()),i.logger&&(c=c.configureLogging(i.logger)),c.build()}return Re.createConnection=n,Re}var $n;function oi(){if($n)return Te;$n=1;var r=Te&&Te.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Te,"__esModule",{value:!0}),Te.providerFactory=void 0;const e=r(ce()),n=ie(),t=r(ln()),i=Kr(),o=ee(),c="IS_SIGNAL_R_CONNECTED",l="KEY_LAST_CONNECTION_TIME";function h(a){return({url:f,connectEnabled:d=!0,automaticReconnect:p=!0,children:_,dependencies:g=[],accessTokenFactory:v,onError:m,onOpen:b,onReconnect:C,onClosed:k,onBeforeClose:A,logger:I,...M})=>{const O=(0,o.useEvent)(m),w=(0,o.useEvent)(v),S=(0,n.useRef)(()=>{});function F(){var P;if(!d)return;const R=(0,i.createConnection)(f,{accessTokenFactory:()=>(w==null?void 0:w())||"",logger:I,...M},p);R.onreconnecting(j=>O==null?void 0:O(j)),R.onreconnected(()=>C==null?void 0:C(R)),a.connection=R,a.reOn(),R.onclose(j=>{k==null||k(j)});let D=Number(t.default.get(l))||null,$=null;e.default.on(c,j=>{if(!j){D=null,$=null,me();return}I&&console.log("Another tab connected"),$=j,D=Date.now(),(0,i.isConnectionConnecting)(R)||(V&&clearInterval(V),R.stop())});let V;async function me(){function j(){if($){clearInterval(V),R.stop();return}s(R.connectionId)}if((!D||D<Date.now()-5e3)&&!(0,i.isConnectionConnecting)(R))try{s(R.connectionId),await R.start(),b==null||b(R),V=setInterval(j,4e3),j()}catch(ue){console.log(ue),V&&clearInterval(V),O==null||O(ue)}}me();const ye=setInterval(me,6e3);function ae(){(0,i.isConnectionConnecting)(R)&&(s(null),clearInterval(V),R.stop())}(P=window==null?void 0:window.addEventListener)===null||P===void 0||P.call(window,"beforeunload",ae),S.current=async()=>{var j;clearInterval(ye),V&&clearInterval(V),await(A==null?void 0:A(R)),R.stop(),e.default.off(c),(j=window==null?void 0:window.removeEventListener)===null||j===void 0||j.call(window,"beforeunload",ae)}}(0,n.useState)(()=>{F()});const E=(0,n.useRef)(!1);return(0,n.useEffect)(()=>(E.current&&F(),E.current=!0,()=>{S.current()}),[d,f,...g]),_}}Te.providerFactory=h;function s(a){if(!a){e.default.send(c,""),t.default.set(l,"");return}e.default.send(c,a);const u=new Date;u.setSeconds(u.getSeconds()+10),t.default.set(l,Date.now().toString(),{expires:u,path:"/"})}return Te}var kt,ii=new Uint8Array(16);function Xr(){if(!kt&&(kt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!kt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kt(ii)}const si=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Nt(r){return typeof r=="string"&&si.test(r)}var W=[];for(var zt=0;zt<256;++zt)W.push((zt+256).toString(16).substr(1));function qt(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(W[r[e+0]]+W[r[e+1]]+W[r[e+2]]+W[r[e+3]]+"-"+W[r[e+4]]+W[r[e+5]]+"-"+W[r[e+6]]+W[r[e+7]]+"-"+W[r[e+8]]+W[r[e+9]]+"-"+W[r[e+10]]+W[r[e+11]]+W[r[e+12]]+W[r[e+13]]+W[r[e+14]]+W[r[e+15]]).toLowerCase();if(!Nt(n))throw TypeError("Stringified UUID is invalid");return n}var Ln,Kt,Xt=0,Jt=0;function ci(r,e,n){var t=e&&n||0,i=e||new Array(16);r=r||{};var o=r.node||Ln,c=r.clockseq!==void 0?r.clockseq:Kt;if(o==null||c==null){var l=r.random||(r.rng||Xr)();o==null&&(o=Ln=[l[0]|1,l[1],l[2],l[3],l[4],l[5]]),c==null&&(c=Kt=(l[6]<<8|l[7])&16383)}var h=r.msecs!==void 0?r.msecs:Date.now(),s=r.nsecs!==void 0?r.nsecs:Jt+1,a=h-Xt+(s-Jt)/1e4;if(a<0&&r.clockseq===void 0&&(c=c+1&16383),(a<0||h>Xt)&&r.nsecs===void 0&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Xt=h,Jt=s,Kt=c,h+=122192928e5;var u=((h&268435455)*1e4+s)%4294967296;i[t++]=u>>>24&255,i[t++]=u>>>16&255,i[t++]=u>>>8&255,i[t++]=u&255;var f=h/4294967296*1e4&268435455;i[t++]=f>>>8&255,i[t++]=f&255,i[t++]=f>>>24&15|16,i[t++]=f>>>16&255,i[t++]=c>>>8|128,i[t++]=c&255;for(var d=0;d<6;++d)i[t+d]=o[d];return e||qt(i)}function Jr(r){if(!Nt(r))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(r.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(r.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(r.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(r.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(r.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}function ai(r){r=unescape(encodeURIComponent(r));for(var e=[],n=0;n<r.length;++n)e.push(r.charCodeAt(n));return e}var ui="6ba7b810-9dad-11d1-80b4-00c04fd430c8",li="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Yr(r,e,n){function t(i,o,c,l){if(typeof i=="string"&&(i=ai(i)),typeof o=="string"&&(o=Jr(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+i.length);if(h.set(o),h.set(i,o.length),h=n(h),h[6]=h[6]&15|e,h[8]=h[8]&63|128,c){l=l||0;for(var s=0;s<16;++s)c[l+s]=h[s];return c}return qt(h)}try{t.name=r}catch{}return t.DNS=ui,t.URL=li,t}function fi(r){if(typeof r=="string"){var e=unescape(encodeURIComponent(r));r=new Uint8Array(e.length);for(var n=0;n<e.length;++n)r[n]=e.charCodeAt(n)}return hi(di(pi(r),r.length*8))}function hi(r){for(var e=[],n=r.length*32,t="0123456789abcdef",i=0;i<n;i+=8){var o=r[i>>5]>>>i%32&255,c=parseInt(t.charAt(o>>>4&15)+t.charAt(o&15),16);e.push(c)}return e}function Gr(r){return(r+64>>>9<<4)+14+1}function di(r,e){r[e>>5]|=128<<e%32,r[Gr(e)-1]=e;for(var n=1732584193,t=-271733879,i=-1732584194,o=271733878,c=0;c<r.length;c+=16){var l=n,h=t,s=i,a=o;n=z(n,t,i,o,r[c],7,-680876936),o=z(o,n,t,i,r[c+1],12,-389564586),i=z(i,o,n,t,r[c+2],17,606105819),t=z(t,i,o,n,r[c+3],22,-1044525330),n=z(n,t,i,o,r[c+4],7,-176418897),o=z(o,n,t,i,r[c+5],12,1200080426),i=z(i,o,n,t,r[c+6],17,-1473231341),t=z(t,i,o,n,r[c+7],22,-45705983),n=z(n,t,i,o,r[c+8],7,1770035416),o=z(o,n,t,i,r[c+9],12,-1958414417),i=z(i,o,n,t,r[c+10],17,-42063),t=z(t,i,o,n,r[c+11],22,-1990404162),n=z(n,t,i,o,r[c+12],7,1804603682),o=z(o,n,t,i,r[c+13],12,-40341101),i=z(i,o,n,t,r[c+14],17,-1502002290),t=z(t,i,o,n,r[c+15],22,1236535329),n=K(n,t,i,o,r[c+1],5,-165796510),o=K(o,n,t,i,r[c+6],9,-1069501632),i=K(i,o,n,t,r[c+11],14,643717713),t=K(t,i,o,n,r[c],20,-373897302),n=K(n,t,i,o,r[c+5],5,-701558691),o=K(o,n,t,i,r[c+10],9,38016083),i=K(i,o,n,t,r[c+15],14,-660478335),t=K(t,i,o,n,r[c+4],20,-405537848),n=K(n,t,i,o,r[c+9],5,568446438),o=K(o,n,t,i,r[c+14],9,-1019803690),i=K(i,o,n,t,r[c+3],14,-187363961),t=K(t,i,o,n,r[c+8],20,1163531501),n=K(n,t,i,o,r[c+13],5,-1444681467),o=K(o,n,t,i,r[c+2],9,-51403784),i=K(i,o,n,t,r[c+7],14,1735328473),t=K(t,i,o,n,r[c+12],20,-1926607734),n=X(n,t,i,o,r[c+5],4,-378558),o=X(o,n,t,i,r[c+8],11,-2022574463),i=X(i,o,n,t,r[c+11],16,1839030562),t=X(t,i,o,n,r[c+14],23,-35309556),n=X(n,t,i,o,r[c+1],4,-1530992060),o=X(o,n,t,i,r[c+4],11,1272893353),i=X(i,o,n,t,r[c+7],16,-155497632),t=X(t,i,o,n,r[c+10],23,-1094730640),n=X(n,t,i,o,r[c+13],4,681279174),o=X(o,n,t,i,r[c],11,-358537222),i=X(i,o,n,t,r[c+3],16,-722521979),t=X(t,i,o,n,r[c+6],23,76029189),n=X(n,t,i,o,r[c+9],4,-640364487),o=X(o,n,t,i,r[c+12],11,-421815835),i=X(i,o,n,t,r[c+15],16,530742520),t=X(t,i,o,n,r[c+2],23,-995338651),n=J(n,t,i,o,r[c],6,-198630844),o=J(o,n,t,i,r[c+7],10,1126891415),i=J(i,o,n,t,r[c+14],15,-1416354905),t=J(t,i,o,n,r[c+5],21,-57434055),n=J(n,t,i,o,r[c+12],6,1700485571),o=J(o,n,t,i,r[c+3],10,-1894986606),i=J(i,o,n,t,r[c+10],15,-1051523),t=J(t,i,o,n,r[c+1],21,-2054922799),n=J(n,t,i,o,r[c+8],6,1873313359),o=J(o,n,t,i,r[c+15],10,-30611744),i=J(i,o,n,t,r[c+6],15,-1560198380),t=J(t,i,o,n,r[c+13],21,1309151649),n=J(n,t,i,o,r[c+4],6,-145523070),o=J(o,n,t,i,r[c+11],10,-1120210379),i=J(i,o,n,t,r[c+2],15,718787259),t=J(t,i,o,n,r[c+9],21,-343485551),n=_e(n,l),t=_e(t,h),i=_e(i,s),o=_e(o,a)}return[n,t,i,o]}function pi(r){if(r.length===0)return[];for(var e=r.length*8,n=new Uint32Array(Gr(e)),t=0;t<e;t+=8)n[t>>5]|=(r[t/8]&255)<<t%32;return n}function _e(r,e){var n=(r&65535)+(e&65535),t=(r>>16)+(e>>16)+(n>>16);return t<<16|n&65535}function gi(r,e){return r<<e|r>>>32-e}function Mt(r,e,n,t,i,o){return _e(gi(_e(_e(e,r),_e(t,o)),i),n)}function z(r,e,n,t,i,o,c){return Mt(e&n|~e&t,r,e,i,o,c)}function K(r,e,n,t,i,o,c){return Mt(e&t|n&~t,r,e,i,o,c)}function X(r,e,n,t,i,o,c){return Mt(e^n^t,r,e,i,o,c)}function J(r,e,n,t,i,o,c){return Mt(n^(e|~t),r,e,i,o,c)}var _i=Yr("v3",48,fi);function vi(r,e,n){r=r||{};var t=r.random||(r.rng||Xr)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=t[i];return e}return qt(t)}function mi(r,e,n,t){switch(r){case 0:return e&n^~e&t;case 1:return e^n^t;case 2:return e&n^e&t^n&t;case 3:return e^n^t}}function Yt(r,e){return r<<e|r>>>32-e}function yi(r){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof r=="string"){var t=unescape(encodeURIComponent(r));r=[];for(var i=0;i<t.length;++i)r.push(t.charCodeAt(i))}else Array.isArray(r)||(r=Array.prototype.slice.call(r));r.push(128);for(var o=r.length/4+2,c=Math.ceil(o/16),l=new Array(c),h=0;h<c;++h){for(var s=new Uint32Array(16),a=0;a<16;++a)s[a]=r[h*64+a*4]<<24|r[h*64+a*4+1]<<16|r[h*64+a*4+2]<<8|r[h*64+a*4+3];l[h]=s}l[c-1][14]=(r.length-1)*8/Math.pow(2,32),l[c-1][14]=Math.floor(l[c-1][14]),l[c-1][15]=(r.length-1)*8&4294967295;for(var u=0;u<c;++u){for(var f=new Uint32Array(80),d=0;d<16;++d)f[d]=l[u][d];for(var p=16;p<80;++p)f[p]=Yt(f[p-3]^f[p-8]^f[p-14]^f[p-16],1);for(var _=n[0],g=n[1],v=n[2],m=n[3],b=n[4],C=0;C<80;++C){var k=Math.floor(C/20),A=Yt(_,5)+mi(k,g,v,m)+b+e[k]+f[C]>>>0;b=m,m=v,v=Yt(g,30)>>>0,g=_,_=A}n[0]=n[0]+_>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+v>>>0,n[3]=n[3]+m>>>0,n[4]=n[4]+b>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var bi=Yr("v5",80,yi);const wi="00000000-0000-0000-0000-000000000000";function Ci(r){if(!Nt(r))throw TypeError("Invalid UUID");return parseInt(r.substr(14,1),16)}const Si=Object.freeze(Object.defineProperty({__proto__:null,NIL:wi,parse:Jr,stringify:qt,v1:ci,v3:_i,v4:vi,v5:bi,validate:Nt,version:Ci},Symbol.toStringTag,{value:"Module"})),ki=cn(Si);var ot={},Un;function Ei(){if(Un)return ot;Un=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.providerNativeFactory=void 0;const r=ie(),e=ee(),n=Kr();function t(i){return({url:c,connectEnabled:l=!0,automaticReconnect:h=!0,children:s,dependencies:a=[],accessTokenFactory:u,onError:f,onOpen:d,onClosed:p,onReconnect:_,onBeforeClose:g,...v})=>{const m=(0,e.useEvent)(f),b=(0,e.useEvent)(u),C=(0,r.useRef)(()=>{});function k(){if(!l)return;const I=(0,n.createConnection)(c,{accessTokenFactory:()=>(b==null?void 0:b())||"",...v},h);I.onreconnecting(w=>m==null?void 0:m(w)),I.onreconnected(()=>_==null?void 0:_(I)),i.connection=I,i.reOn(),I.onclose(w=>{p==null||p(w)});async function M(){if(!(0,n.isConnectionConnecting)(I))try{await I.start(),d==null||d(I)}catch(w){console.log(w),m==null||m(w)}}M();const O=setInterval(M,6e3);C.current=async()=>{clearInterval(O),await(g==null?void 0:g(I)),I.stop()}}(0,r.useState)(()=>{k()});const A=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(A.current&&k(),A.current=!0,()=>{C.current()}),[l,c,...a]),s}}return ot.providerNativeFactory=t,ot}var Wn;function Ti(){if(Wn)return ke;Wn=1;var r=ke&&ke.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ke,"__esModule",{value:!0}),ke.createSignalRContext=void 0;const e=zr,n=r(ce()),t=ee(),i=ri(),o=oi(),c=ki,l=Ei(),h="SIGNAL_R_INVOKE";function s(a){const u=[],f={connection:null,useSignalREffect:null,shareConnectionBetweenTab:(a==null?void 0:a.shareConnectionBetweenTab)||!1,invoke(p,..._){var g;if(!f.shareConnectionBetweenTab)return(g=f.connection)===null||g===void 0?void 0:g.invoke(p,..._);const v=(0,c.v4)();return(0,t.sendWithHermes)(h,{methodName:p,args:_,callbackResponse:v},f.shareConnectionBetweenTab),new Promise(m=>{n.default.on(v,b=>{m(b)})})},Provider:null,on:p=>{var _;u.includes(p)||(_=f.connection)===null||_===void 0||_.on(p,(...g)=>{(0,t.sendWithHermes)(p,g,f.shareConnectionBetweenTab)}),u.push(p)},off:p=>{var _;u.includes(p)&&u.splice(u.indexOf(p),1),u.includes(p)||(_=f.connection)===null||_===void 0||_.off(p)},reOn:()=>{(0,t.removeDuplicates)(u).forEach(_=>{var g;(g=f.connection)===null||g===void 0||g.on(_,(...v)=>{(0,t.sendWithHermes)(_,v,f.shareConnectionBetweenTab)})})}};f.Provider=f.shareConnectionBetweenTab?(0,o.providerFactory)(f):(0,l.providerNativeFactory)(f);async function d(p){var _;const g=await((_=f.connection)===null||_===void 0?void 0:_.invoke(p.methodName,...p.args));(0,t.sendWithHermes)(p.callbackResponse,g,f.shareConnectionBetweenTab)}return f.useSignalREffect=(0,i.createUseSignalREffect)(f),n.default.on(h,p=>{var _;((_=f.connection)===null||_===void 0?void 0:_.state)===e.HubConnectionState.Connected&&d(p)}),f}return ke.createSignalRContext=s,ke}var Hn;function Ri(){return Hn||(Hn=1,function(r){var e=Se&&Se.__createBinding||(Object.create?function(t,i,o,c){c===void 0&&(c=o);var l=Object.getOwnPropertyDescriptor(i,o);(!l||("get"in l?!i.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(t,c,l)}:function(t,i,o,c){c===void 0&&(c=o),t[c]=i[o]}),n=Se&&Se.__exportStar||function(t,i){for(var o in t)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&e(i,t,o)};Object.defineProperty(r,"__esModule",{value:!0}),n(Ti(),r)}(Se)),Se}var Pe={},Ie={},Oe={},Vn;function Pi(){if(Vn)return Oe;Vn=1;var r=Oe&&Oe.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.createUseSocketEffect=void 0;const e=r(ce()),n=ie(),t=ee();function i(o){return(l,h)=>{const s=(0,t.useEvent)(h);(0,n.useEffect)(()=>{var a;function u(f){s(...Array.isArray(f)?f:[f])}return(a=o.on)===null||a===void 0||a.call(o,l),e.default.on(l,u),()=>{var f;(f=o.off)===null||f===void 0||f.call(o,l),e.default.off(l,u)}},[])}}return Oe.createUseSocketEffect=i,Oe}var Fe={},Ae={},ht={exports:{}},Xe={},Gt={},re={},it={},oe={},De={},le={},Qt={},Je={},fe={},zn;function fn(){if(zn)return fe;zn=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.ERROR_PACKET=fe.PACKET_TYPES_REVERSE=fe.PACKET_TYPES=void 0;const r=Object.create(null);fe.PACKET_TYPES=r,r.open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6";const e=Object.create(null);fe.PACKET_TYPES_REVERSE=e,Object.keys(r).forEach(t=>{e[r[t]]=t});const n={type:"error",data:"parser error"};return fe.ERROR_PACKET=n,fe}var Kn;function Ii(){if(Kn)return Je;Kn=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.encodePacket=void 0,Je.encodePacketToBinary=h;const r=fn(),e=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",n=typeof ArrayBuffer=="function",t=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,i=({type:s,data:a},u,f)=>e&&a instanceof Blob?u?f(a):o(a,f):n&&(a instanceof ArrayBuffer||t(a))?u?f(a):o(new Blob([a]),f):f(r.PACKET_TYPES[s]+(a||""));Je.encodePacket=i;const o=(s,a)=>{const u=new FileReader;return u.onload=function(){const f=u.result.split(",")[1];a("b"+(f||""))},u.readAsDataURL(s)};function c(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let l;function h(s,a){if(e&&s.data instanceof Blob)return s.data.arrayBuffer().then(c).then(a);if(n&&(s.data instanceof ArrayBuffer||t(s.data)))return a(c(s.data));i(s,!1,u=>{l||(l=new TextEncoder),a(l.encode(u))})}return Je}var st={},Ne={},Xn;function Oi(){if(Xn)return Ne;Xn=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.decode=Ne.encode=void 0;const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<r.length;i++)e[r.charCodeAt(i)]=i;const n=i=>{let o=new Uint8Array(i),c,l=o.length,h="";for(c=0;c<l;c+=3)h+=r[o[c]>>2],h+=r[(o[c]&3)<<4|o[c+1]>>4],h+=r[(o[c+1]&15)<<2|o[c+2]>>6],h+=r[o[c+2]&63];return l%3===2?h=h.substring(0,h.length-1)+"=":l%3===1&&(h=h.substring(0,h.length-2)+"=="),h};Ne.encode=n;const t=i=>{let o=i.length*.75,c=i.length,l,h=0,s,a,u,f;i[i.length-1]==="="&&(o--,i[i.length-2]==="="&&o--);const d=new ArrayBuffer(o),p=new Uint8Array(d);for(l=0;l<c;l+=4)s=e[i.charCodeAt(l)],a=e[i.charCodeAt(l+1)],u=e[i.charCodeAt(l+2)],f=e[i.charCodeAt(l+3)],p[h++]=s<<2|a>>4,p[h++]=(a&15)<<4|u>>2,p[h++]=(u&3)<<6|f&63;return d};return Ne.decode=t,Ne}var Jn;function Fi(){if(Jn)return st;Jn=1,Object.defineProperty(st,"__esModule",{value:!0}),st.decodePacket=void 0;const r=fn(),e=Oi(),n=typeof ArrayBuffer=="function",t=(c,l)=>{if(typeof c!="string")return{type:"message",data:o(c,l)};const h=c.charAt(0);return h==="b"?{type:"message",data:i(c.substring(1),l)}:r.PACKET_TYPES_REVERSE[h]?c.length>1?{type:r.PACKET_TYPES_REVERSE[h],data:c.substring(1)}:{type:r.PACKET_TYPES_REVERSE[h]}:r.ERROR_PACKET};st.decodePacket=t;const i=(c,l)=>{if(n){const h=(0,e.decode)(c);return o(h,l)}else return{base64:!0,data:c}},o=(c,l)=>{switch(l){case"blob":return c instanceof Blob?c:new Blob([c]);case"arraybuffer":default:return c instanceof ArrayBuffer?c:c.buffer}};return st}var Yn;function gt(){return Yn||(Yn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodePayload=r.decodePacket=r.encodePayload=r.encodePacket=r.protocol=void 0,r.createPacketEncoderStream=l,r.createPacketDecoderStream=u;const e=Ii();Object.defineProperty(r,"encodePacket",{enumerable:!0,get:function(){return e.encodePacket}});const n=Fi();Object.defineProperty(r,"decodePacket",{enumerable:!0,get:function(){return n.decodePacket}});const t=fn(),i="",o=(f,d)=>{const p=f.length,_=new Array(p);let g=0;f.forEach((v,m)=>{(0,e.encodePacket)(v,!1,b=>{_[m]=b,++g===p&&d(_.join(i))})})};r.encodePayload=o;const c=(f,d)=>{const p=f.split(i),_=[];for(let g=0;g<p.length;g++){const v=(0,n.decodePacket)(p[g],d);if(_.push(v),v.type==="error")break}return _};r.decodePayload=c;function l(){return new TransformStream({transform(f,d){(0,e.encodePacketToBinary)(f,p=>{const _=p.length;let g;if(_<126)g=new Uint8Array(1),new DataView(g.buffer).setUint8(0,_);else if(_<65536){g=new Uint8Array(3);const v=new DataView(g.buffer);v.setUint8(0,126),v.setUint16(1,_)}else{g=new Uint8Array(9);const v=new DataView(g.buffer);v.setUint8(0,127),v.setBigUint64(1,BigInt(_))}f.data&&typeof f.data!="string"&&(g[0]|=128),d.enqueue(g),d.enqueue(p)})}})}let h;function s(f){return f.reduce((d,p)=>d+p.length,0)}function a(f,d){if(f[0].length===d)return f.shift();const p=new Uint8Array(d);let _=0;for(let g=0;g<d;g++)p[g]=f[0][_++],_===f[0].length&&(f.shift(),_=0);return f.length&&_<f[0].length&&(f[0]=f[0].slice(_)),p}function u(f,d){h||(h=new TextDecoder);const p=[];let _=0,g=-1,v=!1;return new TransformStream({transform(m,b){for(p.push(m);;){if(_===0){if(s(p)<1)break;const C=a(p,1);v=(C[0]&128)===128,g=C[0]&127,g<126?_=3:g===126?_=1:_=2}else if(_===1){if(s(p)<2)break;const C=a(p,2);g=new DataView(C.buffer,C.byteOffset,C.length).getUint16(0),_=3}else if(_===2){if(s(p)<8)break;const C=a(p,8),k=new DataView(C.buffer,C.byteOffset,C.length),A=k.getUint32(0);if(A>Math.pow(2,21)-1){b.enqueue(t.ERROR_PACKET);break}g=A*Math.pow(2,32)+k.getUint32(4),_=3}else{if(s(p)<g)break;const C=a(p,g);b.enqueue((0,n.decodePacket)(v?C:h.decode(C),d)),_=0}if(g===0||g>f){b.enqueue(t.ERROR_PACKET);break}}}})}r.protocol=4}(Qt)),Qt}function Y(r){if(r)return Ai(r)}function Ai(r){for(var e in Y.prototype)r[e]=Y.prototype[e];return r}Y.prototype.on=Y.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Y.prototype.once=function(r,e){function n(){this.off(r,n),e.apply(this,arguments)}return n.fn=e,this.on(r,n),this};Y.prototype.off=Y.prototype.removeListener=Y.prototype.removeAllListeners=Y.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+r];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var t,i=0;i<n.length;i++)if(t=n[i],t===e||t.fn===e){n.splice(i,1);break}return n.length===0&&delete this._callbacks["$"+r],this};Y.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+r],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(n){n=n.slice(0);for(var t=0,i=n.length;t<i;++t)n[t].apply(this,e)}return this};Y.prototype.emitReserved=Y.prototype.emit;Y.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Y.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Di=Object.freeze(Object.defineProperty({__proto__:null,Emitter:Y},Symbol.toStringTag,{value:"Module"})),Qe=cn(Di);var qe={},se={},Gn;function Ze(){if(Gn)return se;Gn=1,Object.defineProperty(se,"__esModule",{value:!0}),se.defaultBinaryType=se.globalThisShim=se.nextTick=void 0,se.createCookieJar=r,se.nextTick=typeof Promise=="function"&&typeof Promise.resolve=="function"?n=>Promise.resolve().then(n):(n,t)=>t(n,0),se.globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),se.defaultBinaryType="arraybuffer";function r(){}return se}var Qn;function et(){if(Qn)return qe;Qn=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.pick=e,qe.installTimerFunctions=i,qe.byteLength=c,qe.randomString=h;const r=Ze();function e(s,...a){return a.reduce((u,f)=>(s.hasOwnProperty(f)&&(u[f]=s[f]),u),{})}const n=r.globalThisShim.setTimeout,t=r.globalThisShim.clearTimeout;function i(s,a){a.useNativeTimers?(s.setTimeoutFn=n.bind(r.globalThisShim),s.clearTimeoutFn=t.bind(r.globalThisShim)):(s.setTimeoutFn=r.globalThisShim.setTimeout.bind(r.globalThisShim),s.clearTimeoutFn=r.globalThisShim.clearTimeout.bind(r.globalThisShim))}const o=1.33;function c(s){return typeof s=="string"?l(s):Math.ceil((s.byteLength||s.size)*o)}function l(s){let a=0,u=0;for(let f=0,d=s.length;f<d;f++)a=s.charCodeAt(f),a<128?u+=1:a<2048?u+=2:a<55296||a>=57344?u+=3:(f++,u+=4);return u}function h(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}return qe}var ct={},Zn;function Qr(){if(Zn)return ct;Zn=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.encode=r,ct.decode=e;function r(n){let t="";for(let i in n)n.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(n[i]));return t}function e(n){let t={},i=n.split("&");for(let o=0,c=i.length;o<c;o++){let l=i[o].split("=");t[decodeURIComponent(l[0])]=decodeURIComponent(l[1])}return t}return ct}var Et={exports:{}},Zt,er;function hn(){if(er)return Zt;er=1;var r=1e3,e=r*60,n=e*60,t=n*24,i=t*7,o=t*365.25;Zt=function(a,u){u=u||{};var f=typeof a;if(f==="string"&&a.length>0)return c(a);if(f==="number"&&isFinite(a))return u.long?h(a):l(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))};function c(a){if(a=String(a),!(a.length>100)){var u=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(a);if(u){var f=parseFloat(u[1]),d=(u[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return f*o;case"weeks":case"week":case"w":return f*i;case"days":case"day":case"d":return f*t;case"hours":case"hour":case"hrs":case"hr":case"h":return f*n;case"minutes":case"minute":case"mins":case"min":case"m":return f*e;case"seconds":case"second":case"secs":case"sec":case"s":return f*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return f;default:return}}}}function l(a){var u=Math.abs(a);return u>=t?Math.round(a/t)+"d":u>=n?Math.round(a/n)+"h":u>=e?Math.round(a/e)+"m":u>=r?Math.round(a/r)+"s":a+"ms"}function h(a){var u=Math.abs(a);return u>=t?s(a,u,t,"day"):u>=n?s(a,u,n,"hour"):u>=e?s(a,u,e,"minute"):u>=r?s(a,u,r,"second"):a+" ms"}function s(a,u,f,d){var p=u>=f*1.5;return Math.round(a/f)+" "+d+(p?"s":"")}return Zt}var en,tr;function Ni(){if(tr)return en;tr=1;function r(e){t.debug=t,t.default=t,t.coerce=s,t.disable=c,t.enable=o,t.enabled=l,t.humanize=hn(),t.destroy=a,Object.keys(e).forEach(u=>{t[u]=e[u]}),t.names=[],t.skips=[],t.formatters={};function n(u){let f=0;for(let d=0;d<u.length;d++)f=(f<<5)-f+u.charCodeAt(d),f|=0;return t.colors[Math.abs(f)%t.colors.length]}t.selectColor=n;function t(u){let f,d=null,p,_;function g(...v){if(!g.enabled)return;const m=g,b=Number(new Date),C=b-(f||b);m.diff=C,m.prev=f,m.curr=b,f=b,v[0]=t.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let k=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(I,M)=>{if(I==="%%")return"%";k++;const O=t.formatters[M];if(typeof O=="function"){const w=v[k];I=O.call(m,w),v.splice(k,1),k--}return I}),t.formatArgs.call(m,v),(m.log||t.log).apply(m,v)}return g.namespace=u,g.useColors=t.useColors(),g.color=t.selectColor(u),g.extend=i,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==t.namespaces&&(p=t.namespaces,_=t.enabled(u)),_),set:v=>{d=v}}),typeof t.init=="function"&&t.init(g),g}function i(u,f){const d=t(this.namespace+(typeof f>"u"?":":f)+u);return d.log=this.log,d}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let f;const d=(typeof u=="string"?u:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)d[f]&&(u=d[f].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.slice(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function c(){const u=[...t.names.map(h),...t.skips.map(h).map(f=>"-"+f)].join(",");return t.enable(""),u}function l(u){if(u[u.length-1]==="*")return!0;let f,d;for(f=0,d=t.skips.length;f<d;f++)if(t.skips[f].test(u))return!1;for(f=0,d=t.names.length;f<d;f++)if(t.names[f].test(u))return!0;return!1}function h(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function s(u){return u instanceof Error?u.stack||u.message:u}function a(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}return en=r,en}var nr;function tt(){return nr||(nr=1,function(r,e){var n={};e.formatArgs=i,e.save=o,e.load=c,e.useColors=t,e.storage=l(),e.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const a="color: "+this.color;s.splice(1,0,a,"color: inherit");let u=0,f=0;s[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(u++,d==="%c"&&(f=u))}),s.splice(f,0,a)}e.log=console.debug||console.log||(()=>{});function o(s){try{s?e.storage.setItem("debug",s):e.storage.removeItem("debug")}catch{}}function c(){let s;try{s=e.storage.getItem("debug")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=n.DEBUG),s}function l(){try{return localStorage}catch{}}r.exports=Ni()(e);const{formatters:h}=r.exports;h.j=function(s){try{return JSON.stringify(s)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}}(Et,Et.exports)),Et.exports}var rr;function jt(){if(rr)return le;rr=1;var r=le&&le.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(le,"__esModule",{value:!0}),le.Transport=le.TransportError=void 0;const e=gt(),n=Qe,t=et(),i=Qr(),c=(0,r(tt()).default)("engine.io-client:transport");class l extends Error{constructor(a,u,f){super(a),this.description=u,this.context=f,this.type="TransportError"}}le.TransportError=l;class h extends n.Emitter{constructor(a){super(),this.writable=!1,(0,t.installTimerFunctions)(this,a),this.opts=a,this.query=a.query,this.socket=a.socket,this.supportsBinary=!a.forceBase64}onError(a,u,f){return super.emitReserved("error",new l(a,u,f)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(a){this.readyState==="open"?this.write(a):c("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(a){const u=(0,e.decodePacket)(a,this.socket.binaryType);this.onPacket(u)}onPacket(a){super.emitReserved("packet",a)}onClose(a){this.readyState="closed",super.emitReserved("close",a)}pause(a){}createUri(a,u={}){return a+"://"+this._hostname()+this._port()+this.opts.path+this._query(u)}_hostname(){const a=this.opts.hostname;return a.indexOf(":")===-1?a:"["+a+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(a){const u=(0,i.encode)(a);return u.length?"?"+u:""}}return le.Transport=h,le}var or;function Zr(){if(or)return De;or=1;var r=De&&De.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(De,"__esModule",{value:!0}),De.Polling=void 0;const e=jt(),n=et(),t=gt(),o=(0,r(tt()).default)("engine.io-client:polling");class c extends e.Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(h){this.readyState="pausing";const s=()=>{o("paused"),this.readyState="paused",h()};if(this._polling||!this.writable){let a=0;this._polling&&(o("we are currently polling - waiting to pause"),a++,this.once("pollComplete",function(){o("pre-pause polling complete"),--a||s()})),this.writable||(o("we are currently writing - waiting to pause"),a++,this.once("drain",function(){o("pre-pause writing complete"),--a||s()}))}else s()}_poll(){o("polling"),this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(h){o("polling got data %s",h);const s=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};(0,t.decodePayload)(h,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this._poll():o('ignoring poll - transport state "%s"',this.readyState))}doClose(){const h=()=>{o("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(o("transport open - closing"),h()):(o("transport not open - deferring close"),this.once("open",h))}write(h){this.writable=!1,(0,t.encodePayload)(h,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const h=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=(0,n.randomString)()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(h,s)}}return De.Polling=c,De}var at={},ir;function qi(){if(ir)return at;ir=1,Object.defineProperty(at,"__esModule",{value:!0}),at.hasCORS=void 0;let r=!1;try{r=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}return at.hasCORS=r,at}var sr;function on(){if(sr)return oe;sr=1;var r=oe&&oe.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(oe,"__esModule",{value:!0}),oe.XHR=oe.Request=oe.BaseXHR=void 0;const e=Zr(),n=Qe,t=et(),i=Ze(),o=qi(),l=(0,r(tt()).default)("engine.io-client:polling");function h(){}class s extends e.Polling{constructor(g){if(super(g),typeof location<"u"){const v=location.protocol==="https:";let m=location.port;m||(m=v?"443":"80"),this.xd=typeof location<"u"&&g.hostname!==location.hostname||m!==g.port}}doWrite(g,v){const m=this.request({method:"POST",data:g});m.on("success",v),m.on("error",(b,C)=>{this.onError("xhr post error",b,C)})}doPoll(){l("xhr poll");const g=this.request();g.on("data",this.onData.bind(this)),g.on("error",(v,m)=>{this.onError("xhr poll error",v,m)}),this.pollXhr=g}}oe.BaseXHR=s;class a extends n.Emitter{constructor(g,v,m){super(),this.createRequest=g,(0,t.installTimerFunctions)(this,m),this._opts=m,this._method=m.method||"GET",this._uri=v,this._data=m.data!==void 0?m.data:null,this._create()}_create(){var g;const v=(0,t.pick)(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");v.xdomain=!!this._opts.xd;const m=this._xhr=this.createRequest(v);try{l("xhr open %s: %s",this._method,this._uri),m.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){m.setDisableHeaderCheck&&m.setDisableHeaderCheck(!0);for(let b in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(b)&&m.setRequestHeader(b,this._opts.extraHeaders[b])}}catch{}if(this._method==="POST")try{m.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{m.setRequestHeader("Accept","*/*")}catch{}(g=this._opts.cookieJar)===null||g===void 0||g.addCookies(m),"withCredentials"in m&&(m.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(m.timeout=this._opts.requestTimeout),m.onreadystatechange=()=>{var b;m.readyState===3&&((b=this._opts.cookieJar)===null||b===void 0||b.parseCookies(m.getResponseHeader("set-cookie"))),m.readyState===4&&(m.status===200||m.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof m.status=="number"?m.status:0)},0))},l("xhr data %s",this._data),m.send(this._data)}catch(b){this.setTimeoutFn(()=>{this._onError(b)},0);return}typeof document<"u"&&(this._index=a.requestsCount++,a.requests[this._index]=this)}_onError(g){this.emitReserved("error",g,this._xhr),this._cleanup(!0)}_cleanup(g){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=h,g)try{this._xhr.abort()}catch{}typeof document<"u"&&delete a.requests[this._index],this._xhr=null}}_onLoad(){const g=this._xhr.responseText;g!==null&&(this.emitReserved("data",g),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(oe.Request=a,a.requestsCount=0,a.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",u);else if(typeof addEventListener=="function"){const _="onpagehide"in i.globalThisShim?"pagehide":"unload";addEventListener(_,u,!1)}}function u(){for(let _ in a.requests)a.requests.hasOwnProperty(_)&&a.requests[_].abort()}const f=function(){const _=p({xdomain:!1});return _&&_.responseType!==null}();class d extends s{constructor(g){super(g);const v=g&&g.forceBase64;this.supportsBinary=f&&!v}request(g={}){return Object.assign(g,{xd:this.xd},this.opts),new a(p,this.uri(),g)}}oe.XHR=d;function p(_){const g=_.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!g||o.hasCORS))return new XMLHttpRequest}catch{}if(!g)try{return new i.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}return oe}var he={},cr;function sn(){if(cr)return he;cr=1;var r=he&&he.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(he,"__esModule",{value:!0}),he.WS=he.BaseWS=void 0;const e=jt(),n=et(),t=gt(),i=Ze(),c=(0,r(tt()).default)("engine.io-client:websocket"),l=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class h extends e.Transport{get name(){return"websocket"}doOpen(){const f=this.uri(),d=this.opts.protocols,p=l?{}:(0,n.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(p.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(f,d,p)}catch(_){return this.emitReserved("error",_)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=f=>this.onClose({description:"websocket connection closed",context:f}),this.ws.onmessage=f=>this.onData(f.data),this.ws.onerror=f=>this.onError("websocket error",f)}write(f){this.writable=!1;for(let d=0;d<f.length;d++){const p=f[d],_=d===f.length-1;(0,t.encodePacket)(p,this.supportsBinary,g=>{try{this.doWrite(p,g)}catch{c("websocket closed before onclose event")}_&&(0,i.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const f=this.opts.secure?"wss":"ws",d=this.query||{};return this.opts.timestampRequests&&(d[this.opts.timestampParam]=(0,n.randomString)()),this.supportsBinary||(d.b64=1),this.createUri(f,d)}}he.BaseWS=h;const s=i.globalThisShim.WebSocket||i.globalThisShim.MozWebSocket;class a extends h{createSocket(f,d,p){return l?new s(f,d,p):d?new s(f,d):new s(f)}doWrite(f,d){this.ws.send(d)}}return he.WS=a,he}var Me={},ar;function eo(){if(ar)return Me;ar=1;var r=Me&&Me.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Me,"__esModule",{value:!0}),Me.WT=void 0;const e=jt(),n=Ze(),t=gt(),o=(0,r(tt()).default)("engine.io-client:webtransport");class c extends e.Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(h){return this.emitReserved("error",h)}this._transport.closed.then(()=>{o("transport closed gracefully"),this.onClose()}).catch(h=>{o("transport closed due to %s",h),this.onError("webtransport error",h)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(h=>{const s=(0,t.createPacketDecoderStream)(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=h.readable.pipeThrough(s).getReader(),u=(0,t.createPacketEncoderStream)();u.readable.pipeTo(h.writable),this._writer=u.writable.getWriter();const f=()=>{a.read().then(({done:p,value:_})=>{if(p){o("session is closed");return}o("received chunk: %o",_),this.onPacket(_),f()}).catch(p=>{o("an error occurred while reading: %s",p)})};f();const d={type:"open"};this.query.sid&&(d.data=`{"sid":"${this.query.sid}"}`),this._writer.write(d).then(()=>this.onOpen())})})}write(h){this.writable=!1;for(let s=0;s<h.length;s++){const a=h[s],u=s===h.length-1;this._writer.write(a).then(()=>{u&&(0,n.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var h;(h=this._transport)===null||h===void 0||h.close()}}return Me.WT=c,Me}var ur;function to(){if(ur)return it;ur=1,Object.defineProperty(it,"__esModule",{value:!0}),it.transports=void 0;const r=on(),e=sn(),n=eo();return it.transports={websocket:e.WS,webtransport:n.WT,polling:r.XHR},it}var Tt={},lr;function no(){if(lr)return Tt;lr=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.parse=n;const r=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function n(o){if(o.length>8e3)throw"URI too long";const c=o,l=o.indexOf("["),h=o.indexOf("]");l!=-1&&h!=-1&&(o=o.substring(0,l)+o.substring(l,h).replace(/:/g,";")+o.substring(h,o.length));let s=r.exec(o||""),a={},u=14;for(;u--;)a[e[u]]=s[u]||"";return l!=-1&&h!=-1&&(a.source=c,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=t(a,a.path),a.queryKey=i(a,a.query),a}function t(o,c){const l=/\/{2,9}/g,h=c.replace(l,"/").split("/");return(c.slice(0,1)=="/"||c.length===0)&&h.splice(0,1),c.slice(-1)=="/"&&h.splice(h.length-1,1),h}function i(o,c){const l={};return c.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(h,s,a){s&&(l[s]=a)}),l}return Tt}var fr;function hr(){if(fr)return re;fr=1;var r=re&&re.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(re,"__esModule",{value:!0}),re.Socket=re.SocketWithUpgrade=re.SocketWithoutUpgrade=void 0;const e=to(),n=et(),t=Qr(),i=no(),o=Qe,c=gt(),l=Ze(),s=(0,r(tt()).default)("engine.io-client:socket"),a=typeof addEventListener=="function"&&typeof removeEventListener=="function",u=[];a&&addEventListener("offline",()=>{s("closing %d connection(s) because the network was lost",u.length),u.forEach(_=>_())},!1);class f extends o.Emitter{constructor(g,v){if(super(),this.binaryType=l.defaultBinaryType,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,g&&typeof g=="object"&&(v=g,g=null),g){const m=(0,i.parse)(g);v.hostname=m.host,v.secure=m.protocol==="https"||m.protocol==="wss",v.port=m.port,m.query&&(v.query=m.query)}else v.host&&(v.hostname=(0,i.parse)(v.host).host);(0,n.installTimerFunctions)(this,v),this.secure=v.secure!=null?v.secure:typeof location<"u"&&location.protocol==="https:",v.hostname&&!v.port&&(v.port=this.secure?"443":"80"),this.hostname=v.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=v.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},v.transports.forEach(m=>{const b=m.prototype.name;this.transports.push(b),this._transportsByName[b]=m}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},v),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=(0,t.decode)(this.opts.query)),a&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(s("adding listener for the 'offline' event"),this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},u.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=(0,l.createCookieJar)()),this._open()}createTransport(g){s('creating transport "%s"',g);const v=Object.assign({},this.opts.query);v.EIO=c.protocol,v.transport=g,this.id&&(v.sid=this.id);const m=Object.assign({},this.opts,{query:v,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[g]);return s("options: %j",m),new this._transportsByName[g](m)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const g=this.opts.rememberUpgrade&&f.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const v=this.createTransport(g);v.open(),this.setTransport(v)}setTransport(g){s("setting transport %s",g.name),this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=g,g.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",v=>this._onClose("transport close",v))}onOpen(){s("socket open"),this.readyState="open",f.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(g){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(s('socket receive: type "%s", data "%s"',g.type,g.data),this.emitReserved("packet",g),this.emitReserved("heartbeat"),g.type){case"open":this.onHandshake(JSON.parse(g.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const v=new Error("server error");v.code=g.data,this._onError(v);break;case"message":this.emitReserved("data",g.data),this.emitReserved("message",g.data);break}else s('packet received with socket readyState "%s"',this.readyState)}onHandshake(g){this.emitReserved("handshake",g),this.id=g.sid,this.transport.query.sid=g.sid,this._pingInterval=g.pingInterval,this._pingTimeout=g.pingTimeout,this._maxPayload=g.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const g=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+g,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},g),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const g=this._getWritablePackets();s("flushing %d packets in socket",g.length),this.transport.send(g),this._prevBufferLen=g.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let v=1;for(let m=0;m<this.writeBuffer.length;m++){const b=this.writeBuffer[m].data;if(b&&(v+=(0,n.byteLength)(b)),m>0&&v>this._maxPayload)return s("only send %d out of %d packets",m,this.writeBuffer.length),this.writeBuffer.slice(0,m);v+=2}return s("payload size is %d (max: %d)",v,this._maxPayload),this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const g=Date.now()>this._pingTimeoutTime;return g&&(s("throttled timer detected, scheduling connection close"),this._pingTimeoutTime=0,(0,l.nextTick)(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),g}write(g,v,m){return this._sendPacket("message",g,v,m),this}send(g,v,m){return this._sendPacket("message",g,v,m),this}_sendPacket(g,v,m,b){if(typeof v=="function"&&(b=v,v=void 0),typeof m=="function"&&(b=m,m=null),this.readyState==="closing"||this.readyState==="closed")return;m=m||{},m.compress=m.compress!==!1;const C={type:g,data:v,options:m};this.emitReserved("packetCreate",C),this.writeBuffer.push(C),b&&this.once("flush",b),this.flush()}close(){const g=()=>{this._onClose("forced close"),s("socket closing - telling transport to close"),this.transport.close()},v=()=>{this.off("upgrade",v),this.off("upgradeError",v),g()},m=()=>{this.once("upgrade",v),this.once("upgradeError",v)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?m():g()}):this.upgrading?m():g()),this}_onError(g){if(s("socket error %j",g),f.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return s("trying next transport"),this.transports.shift(),this._open();this.emitReserved("error",g),this._onClose("transport error",g)}_onClose(g,v){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(s('socket close with reason: "%s"',g),this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),a&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const m=u.indexOf(this._offlineEventListener);m!==-1&&(s("removing listener for the 'offline' event"),u.splice(m,1))}this.readyState="closed",this.id=null,this.emitReserved("close",g,v),this.writeBuffer=[],this._prevBufferLen=0}}}re.SocketWithoutUpgrade=f,f.protocol=c.protocol;class d extends f{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade){s("starting upgrade probes");for(let g=0;g<this._upgrades.length;g++)this._probe(this._upgrades[g])}}_probe(g){s('probing transport "%s"',g);let v=this.createTransport(g),m=!1;f.priorWebsocketSuccess=!1;const b=()=>{m||(s('probe transport "%s" opened',g),v.send([{type:"ping",data:"probe"}]),v.once("packet",w=>{if(!m)if(w.type==="pong"&&w.data==="probe"){if(s('probe transport "%s" pong',g),this.upgrading=!0,this.emitReserved("upgrading",v),!v)return;f.priorWebsocketSuccess=v.name==="websocket",s('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{m||this.readyState!=="closed"&&(s("changing transport and sending upgrade packet"),O(),this.setTransport(v),v.send([{type:"upgrade"}]),this.emitReserved("upgrade",v),v=null,this.upgrading=!1,this.flush())})}else{s('probe transport "%s" failed',g);const S=new Error("probe error");S.transport=v.name,this.emitReserved("upgradeError",S)}}))};function C(){m||(m=!0,O(),v.close(),v=null)}const k=w=>{const S=new Error("probe error: "+w);S.transport=v.name,C(),s('probe transport "%s" failed because of error: %s',g,w),this.emitReserved("upgradeError",S)};function A(){k("transport closed")}function I(){k("socket closed")}function M(w){v&&w.name!==v.name&&(s('"%s" works - aborting "%s"',w.name,v.name),C())}const O=()=>{v.removeListener("open",b),v.removeListener("error",k),v.removeListener("close",A),this.off("close",I),this.off("upgrading",M)};v.once("open",b),v.once("error",k),v.once("close",A),this.once("close",I),this.once("upgrading",M),this._upgrades.indexOf("webtransport")!==-1&&g!=="webtransport"?this.setTimeoutFn(()=>{m||v.open()},200):v.open()}onHandshake(g){this._upgrades=this._filterUpgrades(g.upgrades),super.onHandshake(g)}_filterUpgrades(g){const v=[];for(let m=0;m<g.length;m++)~this.transports.indexOf(g[m])&&v.push(g[m]);return v}}re.SocketWithUpgrade=d;class p extends d{constructor(g,v={}){const m=typeof g=="object"?g:v;(!m.transports||m.transports&&typeof m.transports[0]=="string")&&(m.transports=(m.transports||["polling","websocket","webtransport"]).map(b=>e.transports[b]).filter(b=>!!b)),super(g,m)}}return re.Socket=p,re}var ut={},dr;function Mi(){if(dr)return ut;dr=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.Fetch=void 0;const r=Zr();class e extends r.Polling{doPoll(){this._fetch().then(t=>{if(!t.ok)return this.onError("fetch read error",t.status,t);t.text().then(i=>this.onData(i))}).catch(t=>{this.onError("fetch read error",t)})}doWrite(t,i){this._fetch(t).then(o=>{if(!o.ok)return this.onError("fetch write error",o.status,o);i()}).catch(o=>{this.onError("fetch write error",o)})}_fetch(t){var i;const o=t!==void 0,c=new Headers(this.opts.extraHeaders);return o&&c.set("content-type","text/plain;charset=UTF-8"),(i=this.socket._cookieJar)===null||i===void 0||i.appendCookies(c),fetch(this.uri(),{method:o?"POST":"GET",body:o?t:null,headers:c,credentials:this.opts.withCredentials?"include":"omit"}).then(l=>{var h;return(h=this.socket._cookieJar)===null||h===void 0||h.parseCookies(l.headers.getSetCookie()),l})}}return ut.Fetch=e,ut}var pr;function dn(){return pr||(pr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.WebTransport=r.WebSocket=r.NodeWebSocket=r.XHR=r.NodeXHR=r.Fetch=r.nextTick=r.parse=r.installTimerFunctions=r.transports=r.TransportError=r.Transport=r.protocol=r.SocketWithUpgrade=r.SocketWithoutUpgrade=r.Socket=void 0;const e=hr();Object.defineProperty(r,"Socket",{enumerable:!0,get:function(){return e.Socket}});var n=hr();Object.defineProperty(r,"SocketWithoutUpgrade",{enumerable:!0,get:function(){return n.SocketWithoutUpgrade}}),Object.defineProperty(r,"SocketWithUpgrade",{enumerable:!0,get:function(){return n.SocketWithUpgrade}}),r.protocol=e.Socket.protocol;var t=jt();Object.defineProperty(r,"Transport",{enumerable:!0,get:function(){return t.Transport}}),Object.defineProperty(r,"TransportError",{enumerable:!0,get:function(){return t.TransportError}});var i=to();Object.defineProperty(r,"transports",{enumerable:!0,get:function(){return i.transports}});var o=et();Object.defineProperty(r,"installTimerFunctions",{enumerable:!0,get:function(){return o.installTimerFunctions}});var c=no();Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return c.parse}});var l=Ze();Object.defineProperty(r,"nextTick",{enumerable:!0,get:function(){return l.nextTick}});var h=Mi();Object.defineProperty(r,"Fetch",{enumerable:!0,get:function(){return h.Fetch}});var s=on();Object.defineProperty(r,"NodeXHR",{enumerable:!0,get:function(){return s.XHR}});var a=on();Object.defineProperty(r,"XHR",{enumerable:!0,get:function(){return a.XHR}});var u=sn();Object.defineProperty(r,"NodeWebSocket",{enumerable:!0,get:function(){return u.WS}});var f=sn();Object.defineProperty(r,"WebSocket",{enumerable:!0,get:function(){return f.WS}});var d=eo();Object.defineProperty(r,"WebTransport",{enumerable:!0,get:function(){return d.WT}})}(Gt)),Gt}var Rt={exports:{}},tn,gr;function ji(){if(gr)return tn;gr=1;function r(e){t.debug=t,t.default=t,t.coerce=s,t.disable=c,t.enable=o,t.enabled=l,t.humanize=hn(),t.destroy=a,Object.keys(e).forEach(u=>{t[u]=e[u]}),t.names=[],t.skips=[],t.formatters={};function n(u){let f=0;for(let d=0;d<u.length;d++)f=(f<<5)-f+u.charCodeAt(d),f|=0;return t.colors[Math.abs(f)%t.colors.length]}t.selectColor=n;function t(u){let f,d=null,p,_;function g(...v){if(!g.enabled)return;const m=g,b=Number(new Date),C=b-(f||b);m.diff=C,m.prev=f,m.curr=b,f=b,v[0]=t.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let k=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(I,M)=>{if(I==="%%")return"%";k++;const O=t.formatters[M];if(typeof O=="function"){const w=v[k];I=O.call(m,w),v.splice(k,1),k--}return I}),t.formatArgs.call(m,v),(m.log||t.log).apply(m,v)}return g.namespace=u,g.useColors=t.useColors(),g.color=t.selectColor(u),g.extend=i,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==t.namespaces&&(p=t.namespaces,_=t.enabled(u)),_),set:v=>{d=v}}),typeof t.init=="function"&&t.init(g),g}function i(u,f){const d=t(this.namespace+(typeof f>"u"?":":f)+u);return d.log=this.log,d}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let f;const d=(typeof u=="string"?u:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)d[f]&&(u=d[f].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.slice(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function c(){const u=[...t.names.map(h),...t.skips.map(h).map(f=>"-"+f)].join(",");return t.enable(""),u}function l(u){if(u[u.length-1]==="*")return!0;let f,d;for(f=0,d=t.skips.length;f<d;f++)if(t.skips[f].test(u))return!1;for(f=0,d=t.names.length;f<d;f++)if(t.names[f].test(u))return!0;return!1}function h(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function s(u){return u instanceof Error?u.stack||u.message:u}function a(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}return tn=r,tn}var _r;function xt(){return _r||(_r=1,function(r,e){var n={};e.formatArgs=i,e.save=o,e.load=c,e.useColors=t,e.storage=l(),e.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const a="color: "+this.color;s.splice(1,0,a,"color: inherit");let u=0,f=0;s[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(u++,d==="%c"&&(f=u))}),s.splice(f,0,a)}e.log=console.debug||console.log||(()=>{});function o(s){try{s?e.storage.setItem("debug",s):e.storage.removeItem("debug")}catch{}}function c(){let s;try{s=e.storage.getItem("debug")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=n.DEBUG),s}function l(){try{return localStorage}catch{}}r.exports=ji()(e);const{formatters:h}=r.exports;h.j=function(s){try{return JSON.stringify(s)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}}(Rt,Rt.exports)),Rt.exports}var vr;function xi(){if(vr)return Xe;vr=1;var r=Xe&&Xe.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.url=i;const e=dn(),t=(0,r(xt()).default)("socket.io-client:url");function i(o,c="",l){let h=o;l=l||typeof location<"u"&&location,o==null&&(o=l.protocol+"//"+l.host),typeof o=="string"&&(o.charAt(0)==="/"&&(o.charAt(1)==="/"?o=l.protocol+o:o=l.host+o),/^(https?|wss?):\/\//.test(o)||(t("protocol-less url %s",o),typeof l<"u"?o=l.protocol+"//"+o:o="https://"+o),t("parse %s",o),h=(0,e.parse)(o)),h.port||(/^(http|ws)$/.test(h.protocol)?h.port="80":/^(http|ws)s$/.test(h.protocol)&&(h.port="443")),h.path=h.path||"/";const a=h.host.indexOf(":")!==-1?"["+h.host+"]":h.host;return h.id=h.protocol+"://"+a+":"+h.port+c,h.href=h.protocol+"://"+a+(l&&l.port===h.port?"":":"+h.port),h}return Xe}var Q={},je={},nn={},xe={},Be={},mr;function ro(){if(mr)return Be;mr=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.hasBinary=Be.isBinary=void 0;const r=typeof ArrayBuffer=="function",e=l=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(l):l.buffer instanceof ArrayBuffer,n=Object.prototype.toString,t=typeof Blob=="function"||typeof Blob<"u"&&n.call(Blob)==="[object BlobConstructor]",i=typeof File=="function"||typeof File<"u"&&n.call(File)==="[object FileConstructor]";function o(l){return r&&(l instanceof ArrayBuffer||e(l))||t&&l instanceof Blob||i&&l instanceof File}Be.isBinary=o;function c(l,h){if(!l||typeof l!="object")return!1;if(Array.isArray(l)){for(let s=0,a=l.length;s<a;s++)if(c(l[s]))return!0;return!1}if(o(l))return!0;if(l.toJSON&&typeof l.toJSON=="function"&&arguments.length===1)return c(l.toJSON(),!0);for(const s in l)if(Object.prototype.hasOwnProperty.call(l,s)&&c(l[s]))return!0;return!1}return Be.hasBinary=c,Be}var yr;function Bi(){if(yr)return xe;yr=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.reconstructPacket=xe.deconstructPacket=void 0;const r=ro();function e(o){const c=[],l=o.data,h=o;return h.data=n(l,c),h.attachments=c.length,{packet:h,buffers:c}}xe.deconstructPacket=e;function n(o,c){if(!o)return o;if((0,r.isBinary)(o)){const l={_placeholder:!0,num:c.length};return c.push(o),l}else if(Array.isArray(o)){const l=new Array(o.length);for(let h=0;h<o.length;h++)l[h]=n(o[h],c);return l}else if(typeof o=="object"&&!(o instanceof Date)){const l={};for(const h in o)Object.prototype.hasOwnProperty.call(o,h)&&(l[h]=n(o[h],c));return l}return o}function t(o,c){return o.data=i(o.data,c),delete o.attachments,o}xe.reconstructPacket=t;function i(o,c){if(!o)return o;if(o&&o._placeholder===!0){if(typeof o.num=="number"&&o.num>=0&&o.num<c.length)return c[o.num];throw new Error("illegal attachments")}else if(Array.isArray(o))for(let l=0;l<o.length;l++)o[l]=i(o[l],c);else if(typeof o=="object")for(const l in o)Object.prototype.hasOwnProperty.call(o,l)&&(o[l]=i(o[l],c));return o}return xe}var Pt={exports:{}},rn,br;function $i(){if(br)return rn;br=1;function r(e){t.debug=t,t.default=t,t.coerce=s,t.disable=c,t.enable=o,t.enabled=l,t.humanize=hn(),t.destroy=a,Object.keys(e).forEach(u=>{t[u]=e[u]}),t.names=[],t.skips=[],t.formatters={};function n(u){let f=0;for(let d=0;d<u.length;d++)f=(f<<5)-f+u.charCodeAt(d),f|=0;return t.colors[Math.abs(f)%t.colors.length]}t.selectColor=n;function t(u){let f,d=null,p,_;function g(...v){if(!g.enabled)return;const m=g,b=Number(new Date),C=b-(f||b);m.diff=C,m.prev=f,m.curr=b,f=b,v[0]=t.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let k=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(I,M)=>{if(I==="%%")return"%";k++;const O=t.formatters[M];if(typeof O=="function"){const w=v[k];I=O.call(m,w),v.splice(k,1),k--}return I}),t.formatArgs.call(m,v),(m.log||t.log).apply(m,v)}return g.namespace=u,g.useColors=t.useColors(),g.color=t.selectColor(u),g.extend=i,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==t.namespaces&&(p=t.namespaces,_=t.enabled(u)),_),set:v=>{d=v}}),typeof t.init=="function"&&t.init(g),g}function i(u,f){const d=t(this.namespace+(typeof f>"u"?":":f)+u);return d.log=this.log,d}function o(u){t.save(u),t.namespaces=u,t.names=[],t.skips=[];let f;const d=(typeof u=="string"?u:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)d[f]&&(u=d[f].replace(/\*/g,".*?"),u[0]==="-"?t.skips.push(new RegExp("^"+u.slice(1)+"$")):t.names.push(new RegExp("^"+u+"$")))}function c(){const u=[...t.names.map(h),...t.skips.map(h).map(f=>"-"+f)].join(",");return t.enable(""),u}function l(u){if(u[u.length-1]==="*")return!0;let f,d;for(f=0,d=t.skips.length;f<d;f++)if(t.skips[f].test(u))return!1;for(f=0,d=t.names.length;f<d;f++)if(t.names[f].test(u))return!0;return!1}function h(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function s(u){return u instanceof Error?u.stack||u.message:u}function a(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}return rn=r,rn}var wr;function Li(){return wr||(wr=1,function(r,e){var n={};e.formatArgs=i,e.save=o,e.load=c,e.useColors=t,e.storage=l(),e.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const a="color: "+this.color;s.splice(1,0,a,"color: inherit");let u=0,f=0;s[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(u++,d==="%c"&&(f=u))}),s.splice(f,0,a)}e.log=console.debug||console.log||(()=>{});function o(s){try{s?e.storage.setItem("debug",s):e.storage.removeItem("debug")}catch{}}function c(){let s;try{s=e.storage.getItem("debug")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=n.DEBUG),s}function l(){try{return localStorage}catch{}}r.exports=$i()(e);const{formatters:h}=r.exports;h.j=function(s){try{return JSON.stringify(s)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}}}(Pt,Pt.exports)),Pt.exports}var Cr;function pn(){return Cr||(Cr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Decoder=r.Encoder=r.PacketType=r.protocol=void 0;const e=Qe,n=Bi(),t=ro(),o=(0,Li().default)("socket.io-parser"),c=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];r.protocol=5;var l;(function(f){f[f.CONNECT=0]="CONNECT",f[f.DISCONNECT=1]="DISCONNECT",f[f.EVENT=2]="EVENT",f[f.ACK=3]="ACK",f[f.CONNECT_ERROR=4]="CONNECT_ERROR",f[f.BINARY_EVENT=5]="BINARY_EVENT",f[f.BINARY_ACK=6]="BINARY_ACK"})(l=r.PacketType||(r.PacketType={}));class h{constructor(d){this.replacer=d}encode(d){return o("encoding packet %j",d),(d.type===l.EVENT||d.type===l.ACK)&&(0,t.hasBinary)(d)?this.encodeAsBinary({type:d.type===l.EVENT?l.BINARY_EVENT:l.BINARY_ACK,nsp:d.nsp,data:d.data,id:d.id}):[this.encodeAsString(d)]}encodeAsString(d){let p=""+d.type;return(d.type===l.BINARY_EVENT||d.type===l.BINARY_ACK)&&(p+=d.attachments+"-"),d.nsp&&d.nsp!=="/"&&(p+=d.nsp+","),d.id!=null&&(p+=d.id),d.data!=null&&(p+=JSON.stringify(d.data,this.replacer)),o("encoded %j as %s",d,p),p}encodeAsBinary(d){const p=(0,n.deconstructPacket)(d),_=this.encodeAsString(p.packet),g=p.buffers;return g.unshift(_),g}}r.Encoder=h;function s(f){return Object.prototype.toString.call(f)==="[object Object]"}class a extends e.Emitter{constructor(d){super(),this.reviver=d}add(d){let p;if(typeof d=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");p=this.decodeString(d);const _=p.type===l.BINARY_EVENT;_||p.type===l.BINARY_ACK?(p.type=_?l.EVENT:l.ACK,this.reconstructor=new u(p),p.attachments===0&&super.emitReserved("decoded",p)):super.emitReserved("decoded",p)}else if((0,t.isBinary)(d)||d.base64)if(this.reconstructor)p=this.reconstructor.takeBinaryData(d),p&&(this.reconstructor=null,super.emitReserved("decoded",p));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+d)}decodeString(d){let p=0;const _={type:Number(d.charAt(0))};if(l[_.type]===void 0)throw new Error("unknown packet type "+_.type);if(_.type===l.BINARY_EVENT||_.type===l.BINARY_ACK){const v=p+1;for(;d.charAt(++p)!=="-"&&p!=d.length;);const m=d.substring(v,p);if(m!=Number(m)||d.charAt(p)!=="-")throw new Error("Illegal attachments");_.attachments=Number(m)}if(d.charAt(p+1)==="/"){const v=p+1;for(;++p&&!(d.charAt(p)===","||p===d.length););_.nsp=d.substring(v,p)}else _.nsp="/";const g=d.charAt(p+1);if(g!==""&&Number(g)==g){const v=p+1;for(;++p;){const m=d.charAt(p);if(m==null||Number(m)!=m){--p;break}if(p===d.length)break}_.id=Number(d.substring(v,p+1))}if(d.charAt(++p)){const v=this.tryParse(d.substr(p));if(a.isPayloadValid(_.type,v))_.data=v;else throw new Error("invalid payload")}return o("decoded %s as %j",d,_),_}tryParse(d){try{return JSON.parse(d,this.reviver)}catch{return!1}}static isPayloadValid(d,p){switch(d){case l.CONNECT:return s(p);case l.DISCONNECT:return p===void 0;case l.CONNECT_ERROR:return typeof p=="string"||s(p);case l.EVENT:case l.BINARY_EVENT:return Array.isArray(p)&&(typeof p[0]=="number"||typeof p[0]=="string"&&c.indexOf(p[0])===-1);case l.ACK:case l.BINARY_ACK:return Array.isArray(p)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}r.Decoder=a;class u{constructor(d){this.packet=d,this.buffers=[],this.reconPack=d}takeBinaryData(d){if(this.buffers.push(d),this.buffers.length===this.reconPack.attachments){const p=(0,n.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),p}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}}(nn)),nn}var It={},Sr;function oo(){if(Sr)return It;Sr=1,Object.defineProperty(It,"__esModule",{value:!0}),It.on=r;function r(e,n,t){return e.on(n,t),function(){e.off(n,t)}}return It}var kr;function io(){if(kr)return je;kr=1;var r=je&&je.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(je,"__esModule",{value:!0}),je.Socket=void 0;const e=pn(),n=oo(),t=Qe,o=(0,r(xt()).default)("socket.io-client:socket"),c=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class l extends t.Emitter{constructor(s,a,u){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=s,this.nsp=a,u&&u.auth&&(this.auth=u.auth),this._opts=Object.assign({},u),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const s=this.io;this.subs=[(0,n.on)(s,"open",this.onopen.bind(this)),(0,n.on)(s,"packet",this.onpacket.bind(this)),(0,n.on)(s,"error",this.onerror.bind(this)),(0,n.on)(s,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...s){return s.unshift("message"),this.emit.apply(this,s),this}emit(s,...a){var u,f,d;if(c.hasOwnProperty(s))throw new Error('"'+s.toString()+'" is a reserved event name');if(a.unshift(s),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(a),this;const p={type:e.PacketType.EVENT,data:a};if(p.options={},p.options.compress=this.flags.compress!==!1,typeof a[a.length-1]=="function"){const m=this.ids++;o("emitting packet with ack id %d",m);const b=a.pop();this._registerAckCallback(m,b),p.id=m}const _=(f=(u=this.io.engine)===null||u===void 0?void 0:u.transport)===null||f===void 0?void 0:f.writable,g=this.connected&&!(!((d=this.io.engine)===null||d===void 0)&&d._hasPingExpired());return this.flags.volatile&&!_?o("discard packet as the transport is not currently writable"):g?(this.notifyOutgoingListeners(p),this.packet(p)):this.sendBuffer.push(p),this.flags={},this}_registerAckCallback(s,a){var u;const f=(u=this.flags.timeout)!==null&&u!==void 0?u:this._opts.ackTimeout;if(f===void 0){this.acks[s]=a;return}const d=this.io.setTimeoutFn(()=>{delete this.acks[s];for(let _=0;_<this.sendBuffer.length;_++)this.sendBuffer[_].id===s&&(o("removing packet with ack id %d from the buffer",s),this.sendBuffer.splice(_,1));o("event with ack id %d has timed out after %d ms",s,f),a.call(this,new Error("operation has timed out"))},f),p=(..._)=>{this.io.clearTimeoutFn(d),a.apply(this,_)};p.withError=!0,this.acks[s]=p}emitWithAck(s,...a){return new Promise((u,f)=>{const d=(p,_)=>p?f(p):u(_);d.withError=!0,a.push(d),this.emit(s,...a)})}_addToQueue(s){let a;typeof s[s.length-1]=="function"&&(a=s.pop());const u={id:this._queueSeq++,tryCount:0,pending:!1,args:s,flags:Object.assign({fromQueue:!0},this.flags)};s.push((f,...d)=>u!==this._queue[0]?void 0:(f!==null?u.tryCount>this._opts.retries&&(o("packet [%d] is discarded after %d tries",u.id,u.tryCount),this._queue.shift(),a&&a(f)):(o("packet [%d] was successfully sent",u.id),this._queue.shift(),a&&a(null,...d)),u.pending=!1,this._drainQueue())),this._queue.push(u),this._drainQueue()}_drainQueue(s=!1){if(o("draining queue"),!this.connected||this._queue.length===0)return;const a=this._queue[0];if(a.pending&&!s){o("packet [%d] has already been sent and is waiting for an ack",a.id);return}a.pending=!0,a.tryCount++,o("sending packet [%d] (try n°%d)",a.id,a.tryCount),this.flags=a.flags,this.emit.apply(this,a.args)}packet(s){s.nsp=this.nsp,this.io._packet(s)}onopen(){o("transport is open - connecting"),typeof this.auth=="function"?this.auth(s=>{this._sendConnectPacket(s)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(s){this.packet({type:e.PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},s):s})}onerror(s){this.connected||this.emitReserved("connect_error",s)}onclose(s,a){o("close (%s)",s),this.connected=!1,delete this.id,this.emitReserved("disconnect",s,a),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(s=>{if(!this.sendBuffer.some(u=>String(u.id)===s)){const u=this.acks[s];delete this.acks[s],u.withError&&u.call(this,new Error("socket has been disconnected"))}})}onpacket(s){if(s.nsp===this.nsp)switch(s.type){case e.PacketType.CONNECT:s.data&&s.data.sid?this.onconnect(s.data.sid,s.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case e.PacketType.EVENT:case e.PacketType.BINARY_EVENT:this.onevent(s);break;case e.PacketType.ACK:case e.PacketType.BINARY_ACK:this.onack(s);break;case e.PacketType.DISCONNECT:this.ondisconnect();break;case e.PacketType.CONNECT_ERROR:this.destroy();const u=new Error(s.data.message);u.data=s.data.data,this.emitReserved("connect_error",u);break}}onevent(s){const a=s.data||[];o("emitting event %j",a),s.id!=null&&(o("attaching ack callback to event"),a.push(this.ack(s.id))),this.connected?this.emitEvent(a):this.receiveBuffer.push(Object.freeze(a))}emitEvent(s){if(this._anyListeners&&this._anyListeners.length){const a=this._anyListeners.slice();for(const u of a)u.apply(this,s)}super.emit.apply(this,s),this._pid&&s.length&&typeof s[s.length-1]=="string"&&(this._lastOffset=s[s.length-1])}ack(s){const a=this;let u=!1;return function(...f){u||(u=!0,o("sending ack %j",f),a.packet({type:e.PacketType.ACK,id:s,data:f}))}}onack(s){const a=this.acks[s.id];if(typeof a!="function"){o("bad ack %s",s.id);return}delete this.acks[s.id],o("calling ack %s with %j",s.id,s.data),a.withError&&s.data.unshift(null),a.apply(this,s.data)}onconnect(s,a){o("socket connected with id %s",s),this.id=s,this.recovered=a&&this._pid===a,this._pid=a,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(s=>this.emitEvent(s)),this.receiveBuffer=[],this.sendBuffer.forEach(s=>{this.notifyOutgoingListeners(s),this.packet(s)}),this.sendBuffer=[]}ondisconnect(){o("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(s=>s()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(o("performing disconnect (%s)",this.nsp),this.packet({type:e.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(s){return this.flags.compress=s,this}get volatile(){return this.flags.volatile=!0,this}timeout(s){return this.flags.timeout=s,this}onAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(s),this}prependAny(s){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(s),this}offAny(s){if(!this._anyListeners)return this;if(s){const a=this._anyListeners;for(let u=0;u<a.length;u++)if(s===a[u])return a.splice(u,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(s),this}prependAnyOutgoing(s){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(s),this}offAnyOutgoing(s){if(!this._anyOutgoingListeners)return this;if(s){const a=this._anyOutgoingListeners;for(let u=0;u<a.length;u++)if(s===a[u])return a.splice(u,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(s){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const a=this._anyOutgoingListeners.slice();for(const u of a)u.apply(this,s.data)}}}return je.Socket=l,je}var Ot={},Er;function Ui(){if(Er)return Ot;Er=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.Backoff=r;function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}return r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),t=Math.floor(n*this.jitter*e);e=Math.floor(n*10)&1?e+t:e-t}return Math.min(e,this.max)|0},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e},Ot}var Tr;function Wi(){if(Tr)return Q;Tr=1;var r=Q&&Q.__createBinding||(Object.create?function(d,p,_,g){g===void 0&&(g=_);var v=Object.getOwnPropertyDescriptor(p,_);(!v||("get"in v?!p.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return p[_]}}),Object.defineProperty(d,g,v)}:function(d,p,_,g){g===void 0&&(g=_),d[g]=p[_]}),e=Q&&Q.__setModuleDefault||(Object.create?function(d,p){Object.defineProperty(d,"default",{enumerable:!0,value:p})}:function(d,p){d.default=p}),n=Q&&Q.__importStar||function(d){if(d&&d.__esModule)return d;var p={};if(d!=null)for(var _ in d)_!=="default"&&Object.prototype.hasOwnProperty.call(d,_)&&r(p,d,_);return e(p,d),p},t=Q&&Q.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Q,"__esModule",{value:!0}),Q.Manager=void 0;const i=dn(),o=io(),c=n(pn()),l=oo(),h=Ui(),s=Qe,u=(0,t(xt()).default)("socket.io-client:manager");class f extends s.Emitter{constructor(p,_){var g;super(),this.nsps={},this.subs=[],p&&typeof p=="object"&&(_=p,p=void 0),_=_||{},_.path=_.path||"/socket.io",this.opts=_,(0,i.installTimerFunctions)(this,_),this.reconnection(_.reconnection!==!1),this.reconnectionAttempts(_.reconnectionAttempts||1/0),this.reconnectionDelay(_.reconnectionDelay||1e3),this.reconnectionDelayMax(_.reconnectionDelayMax||5e3),this.randomizationFactor((g=_.randomizationFactor)!==null&&g!==void 0?g:.5),this.backoff=new h.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(_.timeout==null?2e4:_.timeout),this._readyState="closed",this.uri=p;const v=_.parser||c;this.encoder=new v.Encoder,this.decoder=new v.Decoder,this._autoConnect=_.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(p){return arguments.length?(this._reconnection=!!p,p||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(p){return p===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=p,this)}reconnectionDelay(p){var _;return p===void 0?this._reconnectionDelay:(this._reconnectionDelay=p,(_=this.backoff)===null||_===void 0||_.setMin(p),this)}randomizationFactor(p){var _;return p===void 0?this._randomizationFactor:(this._randomizationFactor=p,(_=this.backoff)===null||_===void 0||_.setJitter(p),this)}reconnectionDelayMax(p){var _;return p===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=p,(_=this.backoff)===null||_===void 0||_.setMax(p),this)}timeout(p){return arguments.length?(this._timeout=p,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(p){if(u("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=new i.Socket(this.uri,this.opts);const _=this.engine,g=this;this._readyState="opening",this.skipReconnect=!1;const v=(0,l.on)(_,"open",function(){g.onopen(),p&&p()}),m=C=>{u("error"),this.cleanup(),this._readyState="closed",this.emitReserved("error",C),p?p(C):this.maybeReconnectOnOpen()},b=(0,l.on)(_,"error",m);if(this._timeout!==!1){const C=this._timeout;u("connect attempt will timeout after %d",C);const k=this.setTimeoutFn(()=>{u("connect attempt timed out after %d",C),v(),m(new Error("timeout")),_.close()},C);this.opts.autoUnref&&k.unref(),this.subs.push(()=>{this.clearTimeoutFn(k)})}return this.subs.push(v),this.subs.push(b),this}connect(p){return this.open(p)}onopen(){u("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const p=this.engine;this.subs.push((0,l.on)(p,"ping",this.onping.bind(this)),(0,l.on)(p,"data",this.ondata.bind(this)),(0,l.on)(p,"error",this.onerror.bind(this)),(0,l.on)(p,"close",this.onclose.bind(this)),(0,l.on)(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(p){try{this.decoder.add(p)}catch(_){this.onclose("parse error",_)}}ondecoded(p){(0,i.nextTick)(()=>{this.emitReserved("packet",p)},this.setTimeoutFn)}onerror(p){u("error",p),this.emitReserved("error",p)}socket(p,_){let g=this.nsps[p];return g?this._autoConnect&&!g.active&&g.connect():(g=new o.Socket(this,p,_),this.nsps[p]=g),g}_destroy(p){const _=Object.keys(this.nsps);for(const g of _)if(this.nsps[g].active){u("socket %s is still active, skipping close",g);return}this._close()}_packet(p){u("writing packet %j",p);const _=this.encoder.encode(p);for(let g=0;g<_.length;g++)this.engine.write(_[g],p.options)}cleanup(){u("cleanup"),this.subs.forEach(p=>p()),this.subs.length=0,this.decoder.destroy()}_close(){u("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(p,_){var g;u("closed due to %s",p),this.cleanup(),(g=this.engine)===null||g===void 0||g.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",p,_),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const p=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const _=this.backoff.duration();u("will wait %dms before reconnect attempt",_),this._reconnecting=!0;const g=this.setTimeoutFn(()=>{p.skipReconnect||(u("attempting reconnect"),this.emitReserved("reconnect_attempt",p.backoff.attempts),!p.skipReconnect&&p.open(v=>{v?(u("reconnect attempt error"),p._reconnecting=!1,p.reconnect(),this.emitReserved("reconnect_error",v)):(u("reconnect success"),p.onreconnect())}))},_);this.opts.autoUnref&&g.unref(),this.subs.push(()=>{this.clearTimeoutFn(g)})}}onreconnect(){const p=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",p)}}return Q.Manager=f,Q}var Rr=ht.exports,Pr;function Hi(){return Pr||(Pr=1,function(r,e){var n=Rr&&Rr.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebTransport=e.WebSocket=e.NodeWebSocket=e.XHR=e.NodeXHR=e.Fetch=e.Socket=e.Manager=e.protocol=void 0,e.io=s,e.connect=s,e.default=s;const t=xi(),i=Wi();Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return i.Manager}});const o=io();Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return o.Socket}});const l=(0,n(xt()).default)("socket.io-client"),h={};function s(f,d){typeof f=="object"&&(d=f,f=void 0),d=d||{};const p=(0,t.url)(f,d.path||"/socket.io"),_=p.source,g=p.id,v=p.path,m=h[g]&&v in h[g].nsps,b=d.forceNew||d["force new connection"]||d.multiplex===!1||m;let C;return b?(l("ignoring socket cache for %s",_),C=new i.Manager(_,d)):(h[g]||(l("new io instance for %s",_),h[g]=new i.Manager(_,d)),C=h[g]),p.query&&!d.query&&(d.query=p.queryKey),C.socket(p.path,d)}Object.assign(s,{Manager:i.Manager,Socket:o.Socket,io:s,connect:s});var a=pn();Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return a.protocol}});var u=dn();Object.defineProperty(e,"Fetch",{enumerable:!0,get:function(){return u.Fetch}}),Object.defineProperty(e,"NodeXHR",{enumerable:!0,get:function(){return u.NodeXHR}}),Object.defineProperty(e,"XHR",{enumerable:!0,get:function(){return u.XHR}}),Object.defineProperty(e,"NodeWebSocket",{enumerable:!0,get:function(){return u.NodeWebSocket}}),Object.defineProperty(e,"WebSocket",{enumerable:!0,get:function(){return u.WebSocket}}),Object.defineProperty(e,"WebTransport",{enumerable:!0,get:function(){return u.WebTransport}}),r.exports=s}(ht,ht.exports)),ht.exports}var Ir;function so(){if(Ir)return Ae;Ir=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.createConnection=Ae.isConnectionConnecting=void 0;const r=Hi();function e(t){return t.connected}Ae.isConnectionConnecting=e;function n(t,i){return(0,r.io)(t,i)}return Ae.createConnection=n,Ae}var Or;function Vi(){if(Or)return Fe;Or=1;var r=Fe&&Fe.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.providerFactory=void 0;const e=r(ce()),n=ie(),t=r(ln()),i=so(),o=ee(),c="IS_SOCKET_CONNECTED",l="KEY_LAST_CONNECTION_TIME";function h(a){return({url:f,connectEnabled:d=!0,automaticReconnect:p=!0,children:_,dependencies:g=[],accessTokenFactory:v,onError:m,...b})=>{const C=(0,o.useEvent)(m),k=(0,o.useEvent)(v),A=(0,n.useRef)(()=>{});function I(){var O;if(!d)return;const w=(0,i.createConnection)(f,{autoConnect:!0,reconnection:p,transportOptions:{polling:{extraHeaders:{Authorization:()=>(k==null?void 0:k())||""}}},...b});a.connection=w,a.reOn();let S=Number(t.default.get(l))||null,F=null;e.default.on(c,$=>{if(!$){S=null,F=null,P();return}o.__DEV__&&console.log("Another tab connected"),F=$,S=Date.now(),(0,i.isConnectionConnecting)(w)||(E&&clearInterval(E),w.close())});let E;async function P(){function $(){if(F){clearInterval(E),w.close();return}s(w.id)}if((!S||S<Date.now()-5e3)&&!(0,i.isConnectionConnecting)(w))try{s(w.id),w.open(),E=setInterval($,4e3),$()}catch(V){console.log(V),E&&clearInterval(E),C==null||C(V)}}P();const R=setInterval(P,6e3);function D(){if((0,i.isConnectionConnecting)(w)){s(null),clearInterval(E),w.disconnect();return}}(O=window==null?void 0:window.addEventListener)===null||O===void 0||O.call(window,"beforeunload",D),A.current=()=>{var $;clearInterval(R),E&&clearInterval(E),w.disconnect(),e.default.off(c),($=window==null?void 0:window.removeEventListener)===null||$===void 0||$.call(window,"beforeunload",D)}}(0,n.useState)(()=>{I()});const M=(0,n.useRef)(!1);return(0,n.useEffect)(()=>(M.current&&I(),M.current=!0,()=>{A.current()}),[d,f,...g]),_}}Fe.providerFactory=h;function s(a){if(!a){e.default.send(c,""),t.default.set(l,"");return}e.default.send(c,a);const u=new Date;u.setSeconds(u.getSeconds()+10),t.default.set(l,Date.now().toString(),{expires:u,path:"/"})}return Fe}var lt={},Fr;function zi(){if(Fr)return lt;Fr=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.providerNativeFactory=void 0;const r=ie(),e=ee(),n=so();function t(i){return({url:c,connectEnabled:l=!0,automaticReconnect:h=!0,children:s,dependencies:a=[],accessTokenFactory:u,onError:f,...d})=>{const p=(0,e.useEvent)(f),_=(0,e.useEvent)(u),g=(0,r.useRef)(()=>{});async function v(){if(!l)return;const b=(0,n.createConnection)(c,{extraHeaders:{Authorization:await(_==null?void 0:_())||""},reconnection:h,...d});i.connection=b,i.reOn();async function C(){if(!(0,n.isConnectionConnecting)(b))try{await b.open()}catch(A){console.log(A),p==null||p(A)}}C();const k=setInterval(C,6e3);g.current=()=>{clearInterval(k),b.disconnect()}}(0,r.useState)(()=>{v()});const m=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(m.current&&v(),m.current=!0,()=>{g.current()}),[l,c,...a]),s}}return lt.providerNativeFactory=t,lt}var Ar;function Ki(){if(Ar)return Ie;Ar=1;var r=Ie&&Ie.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.createSocketIoContext=void 0;const e=r(ce()),n=ee(),t=Pi(),i=Vi(),o=zi(),c="SOCEKT_IO_SEND";function l(h){const s=[],a={connection:null,useSocketEffect:null,shareConnectionBetweenTab:(h==null?void 0:h.shareConnectionBetweenTab)||!1,invoke:(u,...f)=>{var d;if(!a.shareConnectionBetweenTab){(d=a.connection)===null||d===void 0||d.emit(u,...f);return}(0,n.sendWithHermes)(c,{methodName:u,args:f},a.shareConnectionBetweenTab)},Provider:null,on:u=>{var f;s.includes(u)||(f=a.connection)===null||f===void 0||f.on(u,d=>{(0,n.sendWithHermes)(u,d,a.shareConnectionBetweenTab)}),s.push(u)},off:u=>{var f;s.includes(u)&&s.splice(s.indexOf(u),1),s.includes(u)||(f=a.connection)===null||f===void 0||f.off(u)},reOn:()=>{(0,n.removeDuplicates)(s).forEach(f=>{var d;(d=a.connection)===null||d===void 0||d.on(f,p=>{(0,n.sendWithHermes)(f,p,a.shareConnectionBetweenTab)})})}};return a.Provider=a.shareConnectionBetweenTab?(0,i.providerFactory)(a):(0,o.providerNativeFactory)(a),a.useSocketEffect=(0,t.createUseSocketEffect)(a),e.default.on(c,u=>{var f;!((f=a.connection)===null||f===void 0)&&f.connected&&a.connection.emit(u.methodName,...u.args)}),a}return Ie.createSocketIoContext=l,Ie}var Dr;function Xi(){return Dr||(Dr=1,function(r){var e=Pe&&Pe.__createBinding||(Object.create?function(t,i,o,c){c===void 0&&(c=o);var l=Object.getOwnPropertyDescriptor(i,o);(!l||("get"in l?!i.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(t,c,l)}:function(t,i,o,c){c===void 0&&(c=o),t[c]=i[o]}),n=Pe&&Pe.__exportStar||function(t,i){for(var o in t)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&e(i,t,o)};Object.defineProperty(r,"__esModule",{value:!0}),n(Ki(),r)}(Pe)),Pe}var $e={},Le={},Ue={},de={},Nr;function gn(){if(Nr)return de;Nr=1,Object.defineProperty(de,"__esModule",{value:!0}),de.getMessageEvent=de.createConnection=de.isConnectionConnecting=void 0;const r=ee();function e(i){return i&&(i.readyState===WebSocket.CONNECTING||i.readyState===WebSocket.OPEN)}de.isConnectionConnecting=e;function n(i,{url:o,onOpen:c,onClose:l,onErrorRef:h,logger:s,headers:a}){let u;return a?u=new WebSocket(o,null,{headers:a}):u=new WebSocket(o),u.onopen=()=>{c==null||c(u),s==null||s.log("webSocket connected")},u.onmessage=f=>{const d=f.data?JSON.parse(f.data.toString()):{};(0,r.sendWithHermes)(t(i),d,i.shareConnectionBetweenTab)},u.onclose=f=>{l==null||l(f),s==null||s.log("webSocket closed",f)},u.onerror=f=>{var d;return(d=h.current)===null||d===void 0?void 0:d.call(h,f)},i.connection=u,u}de.createConnection=n;function t(i){return i.key+"WEB_SOCKET_EVENT"}return de.getMessageEvent=t,de}var qr;function Ji(){if(qr)return Ue;qr=1;var r=Ue&&Ue.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.createUseSignalREffect=void 0;const e=r(ce()),n=ie(),t=ee(),i=gn();function o(c){return h=>{const s=(0,t.useEvent)(h);(0,n.useEffect)(()=>{function a(u){s(u)}return e.default.on((0,i.getMessageEvent)(c),a),()=>{e.default.off((0,i.getMessageEvent)(c),a)}},[])}}return Ue.createUseSignalREffect=o,Ue}var We={},Mr;function Yi(){if(Mr)return We;Mr=1;var r=We&&We.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(We,"__esModule",{value:!0}),We.providerFactory=void 0;const e=r(ce()),n=ie(),t=r(ln()),i=gn(),o=ee(),c="IS_SIGNAL_R_CONNECTED",l="KEY_LAST_CONNECTION_TIME";function h(a){return({url:f,connectEnabled:d=!0,children:p,dependencies:_=[],onError:g,onOpen:v,onClose:m,logger:b=o.__DEV__?console:null})=>{const C=(0,o.useEvent)(g),k=(0,n.useRef)(()=>{});function A(){var M;if(!d)return;let O=Number(t.default.get(l))||null,w=null;e.default.on(c,R=>{var D;if(!R){O=null,w=null,F();return}b==null||b.log("_anotherTabConnectionId"),w=R,O=Date.now(),(0,i.isConnectionConnecting)(a.connection)||(S&&clearInterval(S),(D=a.connection)===null||D===void 0||D.close())});let S;async function F(){function R(){var D;if(w){clearInterval(S),(D=a.connection)===null||D===void 0||D.close();return}s(String(a.key))}if(b==null||b.log({lastConnectionSentState:O,isConnectionConnecting:(0,i.isConnectionConnecting)(a.connection)}),(!O||O<Date.now()-5e3)&&!(0,i.isConnectionConnecting)(a.connection))try{(0,i.createConnection)(a,{onClose:m,onOpen:v,logger:b,url:f,onErrorRef:C}),s(String(a.key)),S=setInterval(R,4e3),R()}catch(D){b==null||b.error(D.message),S&&clearInterval(S),C==null||C(D)}}F();const E=setInterval(F,6e3);function P(){var R;(0,i.isConnectionConnecting)(a.connection)&&(s(null),clearInterval(S),(R=a.connection)===null||R===void 0||R.close())}(M=window==null?void 0:window.addEventListener)===null||M===void 0||M.call(window,"beforeunload",P),k.current=()=>{var R,D;clearInterval(E),S&&clearInterval(S),(R=a.connection)===null||R===void 0||R.close(),e.default.off(c),(D=window==null?void 0:window.removeEventListener)===null||D===void 0||D.call(window,"beforeunload",P)}}(0,n.useState)(()=>{A()});const I=(0,n.useRef)(!1);return(0,n.useEffect)(()=>(I.current&&A(),I.current=!0,()=>{k.current()}),[d,f,..._]),p}}We.providerFactory=h;function s(a){if(!a){e.default.send(c,""),t.default.set(l,"");return}e.default.send(c,a);const u=new Date;u.setSeconds(u.getSeconds()+10),t.default.set(l,Date.now().toString(),{expires:u,path:"/"})}return We}var ft={},jr;function Gi(){if(jr)return ft;jr=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.providerNativeFactory=void 0;const r=ie(),e=ee(),n=gn();function t(i){return({url:c,connectEnabled:l=!0,children:h,dependencies:s=[],onError:a,onOpen:u,onClose:f,logger:d=console,headers:p})=>{const _=(0,e.useEvent)(a),g=(0,r.useRef)(()=>{});function v(){if(!l)return;async function b(){if(!(0,n.isConnectionConnecting)(i.connection))try{(0,n.createConnection)(i,{onClose:f,onOpen:u,logger:d,url:c,onErrorRef:_,headers:p})}catch(k){console.log(k),_==null||_(k)}}b();const C=setInterval(b,6e3);g.current=()=>{var k;clearInterval(C),(k=i.connection)===null||k===void 0||k.close()}}(0,r.useState)(()=>{v()});const m=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(m.current&&v(),m.current=!0,()=>{g.current()}),[l,c,...s]),h}}return ft.providerNativeFactory=t,ft}var xr;function Qi(){if(xr)return Le;xr=1;var r=Le&&Le.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Le,"__esModule",{value:!0}),Le.createWebSocketContext=void 0;const e=r(ce()),n=ee(),t=Ji(),i=Yi(),o=Gi();function c(l){const h=l.key+"SOCKET_INVOKE",s={key:l.key,connection:null,useWebSocketEffect:null,shareConnectionBetweenTab:(l==null?void 0:l.shareConnectionBetweenTab)||!1,invoke:u=>{var f;if(!s.shareConnectionBetweenTab){(f=s.connection)===null||f===void 0||f.send(JSON.stringify(u));return}(0,n.sendWithHermes)(h,u,s.shareConnectionBetweenTab)},Provider:null};s.Provider=s.shareConnectionBetweenTab?(0,i.providerFactory)(s):(0,o.providerNativeFactory)(s);async function a(u){var f;(f=s.connection)===null||f===void 0||f.send(JSON.stringify(u.data))}return s.useWebSocketEffect=(0,t.createUseSignalREffect)(s),e.default.on(h,u=>{var f;((f=s.connection)===null||f===void 0?void 0:f.readyState)===WebSocket.OPEN&&a(u)}),s}return Le.createWebSocketContext=c,Le}var Br;function Zi(){return Br||(Br=1,function(r){var e=$e&&$e.__createBinding||(Object.create?function(t,i,o,c){c===void 0&&(c=o);var l=Object.getOwnPropertyDescriptor(i,o);(!l||("get"in l?!i.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(t,c,l)}:function(t,i,o,c){c===void 0&&(c=o),t[c]=i[o]}),n=$e&&$e.__exportStar||function(t,i){for(var o in t)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&e(i,t,o)};Object.defineProperty(r,"__esModule",{value:!0}),n(Qi(),r)}($e)),$e}var $r;function es(){return $r||($r=1,function(r){var e=Ce&&Ce.__createBinding||(Object.create?function(t,i,o,c){c===void 0&&(c=o);var l=Object.getOwnPropertyDescriptor(i,o);(!l||("get"in l?!i.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(t,c,l)}:function(t,i,o,c){c===void 0&&(c=o),t[c]=i[o]}),n=Ce&&Ce.__exportStar||function(t,i){for(var o in t)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&e(i,t,o)};Object.defineProperty(r,"__esModule",{value:!0}),n(Ri(),r),n(Xi(),r),n(Zi(),r)}(Ce)),Ce}var ts=es();const ss=ts.createSignalRContext({});export{ss as S,os as l,rs as v};
