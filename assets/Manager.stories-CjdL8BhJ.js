import{j as f}from"./jsx-runtime-D_zvdyIk.js";import{a as N,g as V,r as g}from"./iframe-zpiOQtGo.js";import{S as k}from"./index-6iYvhkm2.js";import{M as E}from"./baza-BnLwLixe.js";import{r as B,a as W,S}from"./index-TJs5-ECo.js";import{u as j,d as G}from"./index-B0qy4s_C.js";var y={},m={},w={},C;function U(){if(C)return w;C=1,Object.defineProperty(w,"__esModule",{value:!0});function r(a,c){return Math.random()*(c-a)+a}return w.default=r,w}var M;function X(){if(M)return m;M=1;var r=m&&m.__extends||function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,l){o.__proto__=l}||function(o,l){for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(o[d]=l[d])},e(n,t)};return function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");e(n,t);function o(){this.constructor=n}n.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),a=m&&m.__read||function(e,n){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var o=t.call(e),l,d=[],h;try{for(;(n===void 0||n-- >0)&&!(l=o.next()).done;)d.push(l.value)}catch(_){h={error:_}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(h)throw h.error}}return d},c=m&&m.__spreadArray||function(e,n,t){if(t||arguments.length===2)for(var o=0,l=n.length,d;o<l;o++)(d||!(o in n))&&(d||(d=Array.prototype.slice.call(n,0,o)),d[o]=n[o]);return e.concat(d||Array.prototype.slice.call(n))},s=m&&m.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m,"__esModule",{value:!0});var u=s(B()),p=s(U()),i=function(e){r(n,e);function n(){var t=e.apply(this,c([],a(arguments),!1))||this;return t.tickAnimation=function(){t.confetti(t.decorateOptions({startVelocity:30,spread:360,ticks:60,zIndex:0,particleCount:150,origin:{x:(0,p.default)(.1,.3),y:Math.random()-.2}})),t.confetti(t.decorateOptions({startVelocity:30,spread:360,ticks:60,zIndex:0,particleCount:150,origin:{x:(0,p.default)(.7,.9),y:Math.random()-.2}}))},t}return n}(u.default);return m.default=i,m}var R;function J(){if(R)return y;R=1;var r=y&&y.__assign||function(){return r=Object.assign||function(i){for(var e,n=1,t=arguments.length;n<t;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=e[o])}return i},r.apply(this,arguments)},a=y&&y.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(y,"__esModule",{value:!0});var c=a(N()),s=a(W()),u=a(X());function p(i){return c.default.createElement(s.default,r({Conductor:u.default},i))}return y.default=p,y}var K=J();const L=V(K);function O(r,a){return Math.random()*(a-r)+r}function $({callback:r}){return g.useEffect(()=>{setTimeout(()=>r(),1e4)},[r]),f.jsxs(f.Fragment,{children:[f.jsx(S,{width:"100%",height:"100%",autorun:{speed:30,duration:1e4},decorateOptions:()=>({particleCount:2,angle:60,spread:55,origin:{x:0},colors:["#000000","#FF0000","#FFFFFF"]})}),f.jsx(S,{width:"100%",height:"100%",autorun:{speed:30,duration:1e4},decorateOptions:()=>({particleCount:2,angle:120,spread:55,origin:{x:1},colors:["#000000","#FF0000","#FFFFFF"]})})]})}$.__docgenInfo={description:"",methods:[],displayName:"Confettyv2",props:{callback:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};async function Q(r){const{src:a,scalar:c=1}=r,s=1/c,u=new Image;u.src=a,await new Promise(H=>u.addEventListener("load",H));const p=10*c,i=r.x??0,e=r.y??0,n=r.width??u.naturalWidth,t=r.height??u.naturalHeight,o=0,l=0,d=p,h=p*t/n,_=new OffscreenCanvas(d,h),F=_.getContext("2d");return F==null||F.drawImage(u,i,e,n,t,o,l,d,h),{type:"bitmap",bitmap:_.transferToImageBitmap(),matrix:[s,0,0,s,-d*s/2,-h*s/2]}}async function Y(r){return new Promise((a,c)=>{const s=new XMLHttpRequest;s.onload=function(){if(s.status===200){const u=new FileReader;u.onloadend=function(){u.result?a(u.result.toString()):c(new Error("Failed to read file"))},u.onerror=function(){c(new Error("Failed to read file"))},u.readAsDataURL(s.response)}else c(new Error(`Failed to load file: ${s.statusText}`))},s.onerror=function(){c(new Error("Failed to send request"))},s.open("GET",r),s.responseType="blob",s.send()})}const Z=({input:r,scalar:a=10})=>{const[c,s]=g.useState([]),u=j(o=>o.parser),p=j(o=>o.parseToLink);if(!u||!p)return;const[i,e]=g.useState(G(r,u,p)),[n,t]=g.useState(null);return g.useEffect(()=>{i!=null&&i.length&&i.length>0&&i.forEach(async o=>{const l=await Y(o),d=await Q({src:l,scalar:a});s(h=>[...h,d])})},[i]),g.useEffect(()=>{c.length>0&&t(f.jsx(L,{width:"100%",height:"100%",autorun:{speed:3,duration:1e4},decorateOptions:()=>({startVelocity:30,spread:360,ticks:60,particleCount:30,shapes:c,scalar:a,origin:{x:O(0,1),y:O(0,1)}})}))},[c,a]),n};function D({callback:r}){return g.useEffect(()=>{setTimeout(()=>r(),1e4)},[r]),f.jsx(L,{width:"100%",height:"100%",autorun:{speed:3,duration:1e4}})}D.__docgenInfo={description:"",methods:[],displayName:"Firework",props:{callback:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};function z(){const[r,a]=g.useState(0),[c,s]=g.useState([]),[u,p]=g.useState([]);k.useSignalREffect("MakeScreenParticles",e=>{const n={type:e,id:r};a(r+1),s(t=>[...t,n])},[]),k.useSignalREffect("MakeScreenEmojisParticles",e=>{const n={input:e,id:r};a(r+1),p(t=>[...t,n])},[]);const i=g.useCallback(e=>{s(n=>n.filter(t=>t.id!==e))},[]);return f.jsxs(f.Fragment,{children:[c.length>0&&c.map(e=>{switch(e.type){case E.Confetty:return f.jsx($,{callback:()=>i(e.id)},e.id);case E.Fireworks:return f.jsx(D,{callback:()=>i(e.id)},e.id)}}),u.length>0&&u.map(e=>f.jsx(Z,{input:e.input},e.id))]})}z.__docgenInfo={description:"",methods:[],displayName:"Manager"};const se={title:"Particles/Manager",component:z,parameters:{layout:"fullscreen",docs:{description:{component:"Менеджер экранных частиц для создания различных визуальных эффектов (конфетти, фейерверки, эмодзи)."}}},tags:["autodocs"],decorators:[r=>f.jsx("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden"},children:f.jsx(r,{})})]},v={args:{}},x={args:{},parameters:{docs:{description:{story:"Пустой менеджер частиц без активных эффектов."}}}};var I,P,q;v.parameters={...v.parameters,docs:{...(I=v.parameters)==null?void 0:I.docs,source:{originalSource:`{
  args: {}
}`,...(q=(P=v.parameters)==null?void 0:P.docs)==null?void 0:q.source}}};var T,b,A;x.parameters={...x.parameters,docs:{...(T=x.parameters)==null?void 0:T.docs,source:{originalSource:`{
  args: {},
  parameters: {
    docs: {
      description: {
        story: 'Пустой менеджер частиц без активных эффектов.'
      }
    }
  }
}`,...(A=(b=x.parameters)==null?void 0:b.docs)==null?void 0:A.source}}};const ie=["Default","Empty"];export{v as Default,x as Empty,ie as __namedExportsOrder,se as default};
